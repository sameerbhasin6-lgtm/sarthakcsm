import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
import io

# ==========================================
# 1. EMBEDDED DATASETS
# ==========================================

# Subscription Data
subscription_csv = """subscription_id,account_id,start_date,end_date,plan_tier,seats,mrr_amount,arr_amount,is_trial,upgrade_flag,downgrade_flag,churn_flag,billing_frequency,auto_renew_flag
SUB001,ACC001,13-01-2023,13-01-2024,Basic,9,180,2160,TRUE,TRUE,FALSE,FALSE,Quarterly,TRUE
SUB002,ACC002,30-10-2023,30-10-2025,Basic,7,140,1680,TRUE,TRUE,FALSE,FALSE,Quarterly,TRUE
SUB003,ACC003,15-10-2023,15-10-2025,Enterprise,179,17900,214800,FALSE,FALSE,TRUE,FALSE,Annual,TRUE
SUB004,ACC004,04-01-2023,04-01-2025,Professional,51,2550,30600,FALSE,FALSE,FALSE,TRUE,Quarterly,FALSE
SUB005,ACC005,17-02-2023,17-02-2025,Basic,16,320,3840,FALSE,TRUE,TRUE,FALSE,Annual,TRUE
SUB006,ACC006,05-03-2023,05-03-2024,Basic,14,280,3360,FALSE,FALSE,FALSE,FALSE,Annual,TRUE
SUB007,ACC007,05-12-2023,05-12-2024,Enterprise,100,10000,120000,TRUE,FALSE,FALSE,FALSE,Monthly,TRUE
SUB008,ACC008,21-08-2023,21-08-2025,Basic,16,320,3840,TRUE,FALSE,FALSE,FALSE,Quarterly,TRUE
SUB009,ACC009,06-02-2023,06-02-2025,Professional,45,2250,27000,TRUE,TRUE,FALSE,FALSE,Annual,TRUE
SUB010,ACC010,23-01-2023,23-01-2024,Professional,79,3950,47400,FALSE,FALSE,FALSE,FALSE,Quarterly,TRUE
SUB011,ACC011,27-08-2023,27-08-2024,Basic,11,220,2640,FALSE,TRUE,FALSE,FALSE,Monthly,TRUE
SUB012,ACC012,23-08-2023,23-08-2025,Basic,9,180,2160,FALSE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB013,ACC013,11-05-2023,11-05-2024,Enterprise,141,14100,169200,TRUE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB014,ACC014,10-09-2023,10-09-2025,Enterprise,200,20000,240000,FALSE,FALSE,FALSE,TRUE,Annual,FALSE
SUB015,ACC015,18-07-2023,18-07-2024,Professional,54,2700,32400,FALSE,TRUE,FALSE,FALSE,Quarterly,TRUE
SUB016,ACC016,20-11-2023,20-11-2024,Professional,37,1850,22200,TRUE,TRUE,FALSE,FALSE,Quarterly,TRUE
SUB017,ACC017,21-07-2023,21-07-2025,Basic,5,100,1200,TRUE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB018,ACC018,24-02-2023,24-02-2025,Enterprise,154,15400,184800,FALSE,FALSE,FALSE,TRUE,Monthly,TRUE
SUB019,ACC019,29-09-2023,29-09-2024,Professional,61,3050,36600,FALSE,FALSE,FALSE,TRUE,Annual,TRUE
SUB020,ACC020,07-06-2023,07-06-2024,Basic,23,460,5520,FALSE,FALSE,FALSE,TRUE,Monthly,TRUE
SUB021,ACC021,29-11-2023,29-11-2025,Basic,20,400,4800,TRUE,FALSE,TRUE,FALSE,Quarterly,FALSE
SUB022,ACC022,07-08-2023,07-08-2024,Enterprise,141,14100,169200,FALSE,FALSE,FALSE,FALSE,Annual,FALSE
SUB023,ACC023,01-06-2023,01-06-2025,Basic,15,300,3600,TRUE,FALSE,TRUE,FALSE,Quarterly,TRUE
SUB024,ACC024,19-07-2023,19-07-2024,Basic,25,500,6000,FALSE,TRUE,FALSE,FALSE,Quarterly,TRUE
SUB025,ACC025,14-11-2023,14-11-2024,Basic,20,400,4800,FALSE,FALSE,FALSE,FALSE,Annual,TRUE
SUB026,ACC026,29-10-2023,29-10-2025,Enterprise,193,19300,231600,FALSE,FALSE,FALSE,TRUE,Monthly,FALSE
SUB027,ACC027,06-08-2023,06-08-2025,Professional,59,2950,35400,TRUE,TRUE,FALSE,FALSE,Quarterly,TRUE
SUB028,ACC028,01-10-2023,01-10-2024,Enterprise,192,19200,230400,FALSE,FALSE,FALSE,FALSE,Quarterly,TRUE
SUB029,ACC029,06-09-2023,06-09-2024,Professional,47,2350,28200,FALSE,FALSE,FALSE,FALSE,Monthly,TRUE
SUB030,ACC030,20-10-2023,20-10-2024,Basic,22,440,5280,TRUE,TRUE,FALSE,FALSE,Monthly,TRUE
SUB031,ACC031,23-05-2023,23-05-2025,Professional,55,2750,33000,FALSE,FALSE,FALSE,TRUE,Monthly,TRUE
SUB032,ACC032,12-12-2023,12-12-2025,Basic,22,440,5280,FALSE,TRUE,FALSE,FALSE,Monthly,TRUE
SUB033,ACC033,28-10-2023,28-10-2025,Enterprise,97,9700,116400,FALSE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB034,ACC034,17-06-2023,17-06-2024,Enterprise,100,10000,120000,FALSE,FALSE,FALSE,FALSE,Annual,TRUE
SUB035,ACC035,28-08-2023,28-08-2024,Basic,23,460,5520,FALSE,FALSE,FALSE,FALSE,Annual,TRUE
SUB036,ACC036,30-10-2023,30-10-2025,Professional,66,3300,39600,TRUE,FALSE,FALSE,FALSE,Quarterly,TRUE
SUB037,ACC037,28-07-2023,28-07-2025,Basic,9,180,2160,FALSE,FALSE,FALSE,FALSE,Annual,TRUE
SUB038,ACC038,15-06-2023,15-06-2024,Basic,11,220,2640,FALSE,FALSE,FALSE,FALSE,Monthly,TRUE
SUB039,ACC039,10-04-2023,10-04-2025,Basic,19,380,4560,FALSE,TRUE,FALSE,FALSE,Quarterly,TRUE
SUB040,ACC040,11-12-2023,11-12-2025,Enterprise,103,10300,123600,TRUE,FALSE,FALSE,FALSE,Annual,TRUE
SUB041,ACC041,04-09-2023,04-09-2024,Basic,24,480,5760,TRUE,FALSE,FALSE,FALSE,Annual,TRUE
SUB042,ACC042,20-11-2023,20-11-2024,Professional,46,2300,27600,FALSE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB043,ACC043,24-05-2023,24-05-2025,Professional,38,1900,22800,TRUE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB044,ACC044,10-04-2023,10-04-2024,Professional,37,1850,22200,FALSE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB045,ACC045,07-06-2023,07-06-2025,Professional,39,1950,23400,FALSE,FALSE,FALSE,FALSE,Annual,TRUE
SUB046,ACC046,24-11-2023,24-11-2025,Basic,12,240,2880,FALSE,TRUE,FALSE,FALSE,Annual,TRUE
SUB047,ACC047,12-05-2023,12-05-2025,Enterprise,120,12000,144000,FALSE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB048,ACC048,05-05-2023,05-05-2024,Enterprise,132,13200,158400,FALSE,FALSE,FALSE,FALSE,Annual,TRUE
SUB049,ACC049,29-08-2023,29-08-2025,Professional,43,2150,25800,TRUE,FALSE,FALSE,FALSE,Quarterly,TRUE
SUB050,ACC050,25-11-2023,25-11-2024,Basic,15,300,3600,FALSE,TRUE,FALSE,FALSE,Annual,TRUE
SUB051,ACC051,04-09-2023,04-09-2025,Professional,43,2150,25800,FALSE,TRUE,FALSE,FALSE,Quarterly,FALSE
SUB052,ACC052,21-01-2023,21-01-2025,Basic,13,260,3120,FALSE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB053,ACC053,30-11-2023,30-11-2024,Professional,40,2000,24000,FALSE,TRUE,FALSE,FALSE,Annual,TRUE
SUB054,ACC054,26-11-2023,26-11-2025,Professional,49,2450,29400,FALSE,FALSE,FALSE,FALSE,Annual,FALSE
SUB055,ACC055,30-07-2022,30-07-2024,Professional,64,3200,38400,FALSE,TRUE,FALSE,FALSE,Annual,FALSE
SUB056,ACC056,18-05-2023,18-05-2025,Professional,62,3100,37200,FALSE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB057,ACC057,21-08-2023,21-08-2024,Professional,59,2950,35400,TRUE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB058,ACC058,14-11-2023,14-11-2025,Professional,54,2700,32400,FALSE,TRUE,FALSE,FALSE,Monthly,FALSE
SUB059,ACC059,27-11-2023,27-11-2024,Professional,49,2450,29400,TRUE,TRUE,FALSE,FALSE,Monthly,FALSE
SUB060,ACC060,27-11-2023,27-11-2025,Enterprise,141,14100,169200,TRUE,FALSE,FALSE,FALSE,Annual,FALSE
SUB061,ACC061,20-03-2023,20-03-2025,Professional,58,2900,34800,FALSE,FALSE,FALSE,FALSE,Annual,TRUE
SUB062,ACC062,07-07-2023,07-07-2024,Basic,8,160,1920,FALSE,TRUE,FALSE,FALSE,Annual,TRUE
SUB063,ACC063,03-07-2023,03-07-2025,Basic,19,380,4560,FALSE,FALSE,FALSE,FALSE,Quarterly,TRUE
SUB064,ACC064,28-05-2023,28-05-2025,Enterprise,111,11100,133200,FALSE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB065,ACC065,01-07-2023,01-07-2024,Professional,38,1900,22800,FALSE,TRUE,FALSE,FALSE,Annual,FALSE
SUB066,ACC066,27-11-2023,27-11-2025,Professional,46,2300,27600,TRUE,FALSE,TRUE,FALSE,Quarterly,FALSE
SUB067,ACC067,26-06-2023,26-06-2025,Professional,55,2750,33000,FALSE,FALSE,FALSE,TRUE,Quarterly,FALSE
SUB068,ACC068,22-06-2023,22-06-2025,Enterprise,131,13100,157200,FALSE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB069,ACC069,20-07-2023,20-07-2024,Basic,15,300,3600,FALSE,TRUE,FALSE,FALSE,Monthly,TRUE
SUB070,ACC070,14-03-2023,14-03-2024,Professional,57,2850,34200,FALSE,FALSE,FALSE,FALSE,Quarterly,TRUE
SUB071,ACC071,02-06-2023,02-06-2024,Professional,43,2150,25800,TRUE,FALSE,FALSE,FALSE,Annual,FALSE
SUB072,ACC072,09-11-2023,09-11-2025,Enterprise,142,14200,170400,FALSE,FALSE,FALSE,FALSE,Quarterly,TRUE
SUB073,ACC073,28-11-2023,28-11-2024,Professional,68,3400,40800,TRUE,FALSE,FALSE,TRUE,Annual,FALSE
SUB074,ACC074,26-11-2023,26-11-2025,Basic,8,160,1920,TRUE,TRUE,FALSE,FALSE,Monthly,TRUE
SUB075,ACC075,28-11-2023,28-11-2025,Enterprise,150,15000,180000,TRUE,FALSE,FALSE,FALSE,Quarterly,TRUE
SUB076,ACC076,27-11-2023,27-11-2025,Enterprise,142,14200,170400,FALSE,FALSE,FALSE,FALSE,Monthly,TRUE
SUB077,ACC077,25-11-2023,25-11-2025,Basic,8,160,1920,FALSE,FALSE,FALSE,FALSE,Annual,FALSE
SUB078,ACC078,11-06-2023,11-06-2025,Professional,73,3650,43800,FALSE,FALSE,FALSE,TRUE,Monthly,FALSE
SUB079,ACC079,21-11-2023,21-11-2025,Enterprise,131,13100,157200,FALSE,TRUE,FALSE,FALSE,Quarterly,FALSE
SUB080,ACC080,20-05-2023,20-05-2025,Enterprise,142,14200,170400,FALSE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB081,ACC081,05-07-2023,05-07-2025,Enterprise,144,14400,172800,TRUE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB082,ACC082,24-11-2023,24-11-2025,Professional,73,3650,43800,FALSE,FALSE,FALSE,TRUE,Monthly,TRUE
SUB083,ACC083,20-07-2023,20-07-2025,Enterprise,142,14200,170400,FALSE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB084,ACC084,18-06-2023,18-06-2025,Professional,43,2150,25800,FALSE,FALSE,FALSE,FALSE,Annual,FALSE
SUB085,ACC085,21-11-2023,21-11-2025,Professional,46,2300,27600,TRUE,FALSE,FALSE,FALSE,Quarterly,TRUE
SUB086,ACC086,15-10-2023,15-10-2025,Basic,15,300,3600,FALSE,FALSE,FALSE,FALSE,Annual,FALSE
SUB087,ACC087,25-11-2023,25-11-2025,Basic,7,140,1680,FALSE,TRUE,FALSE,FALSE,Monthly,FALSE
SUB088,ACC088,24-07-2023,24-07-2025,Professional,57,2850,34200,FALSE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB089,ACC089,28-11-2023,28-11-2025,Professional,34,1700,20400,TRUE,TRUE,FALSE,FALSE,Quarterly,FALSE
SUB090,ACC090,23-10-2023,23-10-2025,Professional,45,2250,27000,FALSE,FALSE,FALSE,FALSE,Annual,TRUE
SUB091,ACC091,08-11-2023,08-11-2025,Professional,77,3850,46200,FALSE,TRUE,FALSE,FALSE,Monthly,FALSE
SUB092,ACC092,25-10-2023,25-10-2025,Basic,11,220,2640,FALSE,FALSE,FALSE,TRUE,Quarterly,FALSE
SUB093,ACC093,27-11-2023,27-11-2025,Basic,20,400,4800,TRUE,FALSE,FALSE,FALSE,Annual,TRUE
SUB094,ACC094,29-10-2023,29-10-2025,Enterprise,127,12700,152400,FALSE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB095,ACC095,29-09-2023,29-09-2025,Basic,6,120,1440,TRUE,FALSE,FALSE,FALSE,Annual,FALSE
SUB096,ACC096,06-10-2023,06-10-2025,Enterprise,163,16300,195600,TRUE,FALSE,FALSE,FALSE,Monthly,TRUE
SUB097,ACC097,27-10-2023,27-10-2025,Basic,20,400,4800,FALSE,TRUE,FALSE,FALSE,Annual,TRUE
SUB098,ACC098,24-08-2023,24-08-2025,Basic,23,460,5520,FALSE,FALSE,FALSE,TRUE,Monthly,TRUE
SUB099,ACC099,02-01-2023,02-01-2025,Professional,80,4000,48000,FALSE,FALSE,FALSE,FALSE,Monthly,TRUE
SUB100,ACC100,08-10-2023,08-10-2025,Enterprise,144,14400,172800,FALSE,FALSE,FALSE,FALSE,Annual,FALSE
SUB101,ACC101,12-04-2023,12-04-2025,Professional,46,2300,27600,TRUE,TRUE,FALSE,TRUE,Quarterly,FALSE
SUB102,ACC102,23-10-2023,23-10-2025,Basic,23,460,5520,FALSE,TRUE,FALSE,FALSE,Annual,TRUE
SUB103,ACC103,30-10-2023,30-10-2025,Enterprise,142,14200,170400,FALSE,FALSE,FALSE,FALSE,Monthly,TRUE
SUB104,ACC104,20-07-2023,20-07-2025,Enterprise,142,14200,170400,FALSE,FALSE,FALSE,FALSE,Monthly,TRUE
SUB105,ACC105,05-10-2023,05-10-2025,Professional,33,1650,19800,TRUE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB106,ACC106,22-10-2023,22-10-2025,Enterprise,131,13100,157200,FALSE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB107,ACC107,07-11-2023,07-11-2025,Professional,46,2300,27600,TRUE,FALSE,FALSE,FALSE,Quarterly,TRUE
SUB108,ACC108,02-11-2023,02-11-2025,Basic,13,260,3120,TRUE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB109,ACC109,15-08-2023,15-08-2025,Basic,21,420,5040,FALSE,FALSE,FALSE,FALSE,Monthly,TRUE
SUB110,ACC110,21-10-2023,21-10-2025,Basic,6,120,1440,FALSE,FALSE,FALSE,FALSE,Quarterly,TRUE
SUB111,ACC111,05-11-2023,05-11-2025,Enterprise,144,14400,172800,FALSE,FALSE,FALSE,FALSE,Annual,FALSE
SUB112,ACC112,28-11-2023,28-11-2025,Professional,39,1950,23400,TRUE,TRUE,FALSE,FALSE,Annual,TRUE
SUB113,ACC113,19-08-2023,19-08-2025,Basic,6,120,1440,FALSE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB114,ACC114,04-10-2023,04-10-2025,Basic,6,120,1440,FALSE,FALSE,FALSE,TRUE,Monthly,TRUE
SUB115,ACC115,15-11-2023,15-11-2025,Enterprise,142,14200,170400,TRUE,TRUE,FALSE,FALSE,Annual,FALSE
SUB116,ACC116,20-10-2023,20-10-2025,Professional,33,1650,19800,FALSE,TRUE,FALSE,FALSE,Quarterly,FALSE
SUB117,ACC117,30-08-2023,30-08-2025,Professional,49,2450,29400,FALSE,FALSE,FALSE,FALSE,Annual,FALSE
SUB118,ACC118,05-11-2023,05-11-2025,Basic,18,360,4320,FALSE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB119,ACC119,02-01-2023,02-01-2025,Enterprise,197,19700,236400,FALSE,FALSE,TRUE,FALSE,Annual,TRUE
SUB120,ACC120,05-09-2023,05-09-2024,Professional,78,3900,46800,FALSE,FALSE,TRUE,FALSE,Quarterly,FALSE
SUB121,ACC121,24-12-2023,24-12-2024,Professional,44,2200,26400,FALSE,FALSE,FALSE,TRUE,Quarterly,FALSE
SUB122,ACC122,15-07-2023,15-07-2024,Enterprise,191,19100,229200,TRUE,FALSE,TRUE,FALSE,Monthly,TRUE
SUB123,ACC123,15-09-2023,15-09-2024,Enterprise,198,19800,237600,FALSE,FALSE,FALSE,TRUE,Monthly,FALSE
SUB124,ACC124,15-03-2023,15-03-2025,Enterprise,109,10900,130800,TRUE,FALSE,FALSE,FALSE,Annual,FALSE
SUB125,ACC125,16-11-2023,16-11-2024,Professional,51,2550,30600,FALSE,FALSE,FALSE,FALSE,Monthly,FALSE
SUB126,ACC126,07-09-2023,07-09-2024,Professional,45,2250,27000,FALSE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB127,ACC127,20-02-2023,20-02-2025,Professional,69,3450,41400,FALSE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB128,ACC128,14-09-2023,14-09-2024,Basic,5,100,1200,TRUE,FALSE,FALSE,FALSE,Annual,FALSE
SUB129,ACC129,10-11-2023,10-11-2024,Enterprise,125,12500,150000,FALSE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB130,ACC130,31-10-2023,31-10-2024,Enterprise,131,13100,157200,TRUE,FALSE,FALSE,FALSE,Quarterly,FALSE
SUB131,ACC131,31-10-2023,31-10-2024,Basic,10,200,2400,FALSE,TRUE,FALSE,FALSE,Monthly,FALSE
SUB132,ACC132,31-10-2023,31-10-2024,Professional,55,2750,33000,FALSE,TRUE,FALSE,FALSE,Monthly,FALSE
SUB133,ACC133,12-10-2023,12-10-2024,Professional,39,1950,23400,TRUE,FALSE,FALSE,FALSE,Monthly,FALSE
"""

# Account Data
account_csv = """account_id,account_name,industry,country,signup_date,referral_source,plan_tier,seats,is_trial,churn_flag
ACC001,Company1 Solutions,Logistics,UK,13-01-2023,Referral,Basic,9,TRUE,FALSE
ACC002,Company2 Solutions,Hospitality,UK,30-10-2023,Google Ads,Basic,7,TRUE,FALSE
ACC003,Company3 Solutions,Cybersecurity,USA,15-10-2023,LinkedIn,Enterprise,179,FALSE,FALSE
ACC004,Company4 Solutions,Cybersecurity,Australia,04-01-2023,LinkedIn,Professional,51,FALSE,TRUE
ACC005,Company5 Solutions,Construction,UK,17-02-2023,Google Ads,Basic,16,FALSE,FALSE
ACC006,Company6 Solutions,Agriculture,France,05-03-2023,Google Ads,Basic,14,FALSE,FALSE
ACC007,Company7 Solutions,Retail,USA,05-12-2023,LinkedIn,Enterprise,100,TRUE,FALSE
ACC008,Company8 Solutions,Marketing,Australia,21-08-2023,Referral,Basic,16,TRUE,FALSE
ACC009,Company9 Solutions,Logistics,Japan,06-02-2023,LinkedIn,Professional,45,TRUE,FALSE
ACC010,Company10 Solutions,Education,Germany,23-01-2023,Google Ads,Professional,79,FALSE,FALSE
ACC011,Company11 Solutions,Technology,USA,27-08-2023,Website,Basic,11,FALSE,FALSE
ACC012,Company12 Solutions,Agriculture,Australia,23-08-2023,Google Ads,Basic,9,FALSE,FALSE
ACC013,Company13 Solutions,Hospitality,France,11-05-2023,LinkedIn,Enterprise,141,TRUE,FALSE
ACC014,Company14 Solutions,Healthcare,USA,10-09-2023,Referral,Enterprise,200,FALSE,TRUE
ACC015,Company15 Solutions,Healthcare,UK,18-07-2023,Referral,Professional,54,FALSE,FALSE
ACC016,Company16 Solutions,Agriculture,India,20-11-2023,Google Ads,Professional,37,TRUE,FALSE
ACC017,Company17 Solutions,Construction,USA,21-07-2023,LinkedIn,Basic,5,TRUE,FALSE
ACC018,Company18 Solutions,Healthcare,USA,24-02-2023,Google Ads,Enterprise,154,FALSE,TRUE
ACC019,Company19 Solutions,Healthcare,UK,29-09-2023,Website,Professional,61,FALSE,TRUE
ACC020,Company20 Solutions,Construction,Germany,07-06-2023,Referral,Basic,23,FALSE,TRUE
ACC021,Company21 Solutions,Agriculture,Canada,29-11-2023,Google Ads,Basic,20,TRUE,FALSE
ACC022,Company22 Solutions,Cybersecurity,France,07-08-2023,Referral,Enterprise,141,FALSE,FALSE
ACC023,Company23 Solutions,Hospitality,UK,01-06-2023,Google Ads,Basic,15,TRUE,FALSE
ACC024,Company24 Solutions,Finance,Australia,19-07-2023,LinkedIn,Basic,25,FALSE,FALSE
ACC025,Company25 Solutions,Technology,USA,14-11-2023,Google Ads,Basic,20,FALSE,FALSE
ACC026,Company26 Solutions,Cybersecurity,Netherlands,29-10-2023,Referral,Enterprise,193,FALSE,TRUE
ACC027,Company27 Solutions,Retail,India,06-08-2023,Website,Professional,59,TRUE,FALSE
ACC028,Company28 Solutions,Logistics,USA,01-10-2023,LinkedIn,Enterprise,192,FALSE,FALSE
ACC029,Company29 Solutions,Finance,Singapore,06-09-2023,Referral,Professional,47,FALSE,FALSE
ACC030,Company30 Solutions,Retail,UK,20-10-2023,Website,Basic,22,TRUE,FALSE
ACC031,Company31 Solutions,Finance,France,23-05-2023,Google Ads,Professional,55,FALSE,TRUE
ACC032,Company32 Solutions,Technology,Germany,12-12-2023,LinkedIn,Basic,22,FALSE,FALSE
ACC033,Company33 Solutions,Education,USA,28-10-2023,Website,Enterprise,97,FALSE,FALSE
ACC034,Company34 Solutions,Hospitality,Australia,17-06-2023,Referral,Enterprise,100,FALSE,FALSE
ACC035,Company35 Solutions,Retail,Canada,28-08-2023,Google Ads,Basic,23,FALSE,FALSE
ACC036,Company36 Solutions,Technology,India,30-10-2023,LinkedIn,Professional,66,TRUE,FALSE
ACC037,Company37 Solutions,Finance,USA,28-07-2023,Website,Basic,9,FALSE,FALSE
ACC038,Company38 Solutions,Retail,UK,15-06-2023,Referral,Basic,11,FALSE,FALSE
ACC039,Company39 Solutions,Construction,Netherlands,10-04-2023,Google Ads,Basic,19,FALSE,FALSE
ACC040,Company40 Solutions,Logistics,USA,11-12-2023,Website,Enterprise,103,TRUE,FALSE
ACC041,Company41 Solutions,Retail,France,04-09-2023,LinkedIn,Basic,24,TRUE,FALSE
ACC042,Company42 Solutions,Finance,Singapore,20-11-2023,Referral,Professional,46,FALSE,FALSE
ACC043,Company43 Solutions,Marketing,Australia,24-05-2023,Google Ads,Professional,38,TRUE,FALSE
ACC044,Company44 Solutions,Agriculture,Germany,10-04-2023,Website,Professional,37,FALSE,FALSE
ACC045,Company45 Solutions,Healthcare,USA,07-06-2023,LinkedIn,Professional,39,FALSE,FALSE
ACC046,Company46 Solutions,Education,UK,24-11-2023,Referral,Basic,12,FALSE,FALSE
ACC047,Company47 Solutions,Hospitality,India,12-05-2023,Google Ads,Enterprise,120,FALSE,FALSE
ACC048,Company48 Solutions,Healthcare,USA,05-05-2023,Website,Enterprise,132,FALSE,FALSE
ACC049,Company49 Solutions,Finance,Canada,29-08-2023,LinkedIn,Professional,43,TRUE,FALSE
ACC050,Company50 Solutions,Agriculture,Netherlands,25-11-2023,Google Ads,Basic,15,FALSE,FALSE
ACC051,Company51 Solutions,Retail,USA,04-09-2023,Referral,Professional,43,FALSE,FALSE
ACC052,Company52 Solutions,Retail,UK,21-01-2023,Website,Basic,13,FALSE,FALSE
ACC053,Company53 Solutions,Construction,France,30-11-2023,Google Ads,Professional,40,FALSE,FALSE
ACC054,Company54 Solutions,Marketing,Germany,26-11-2023,LinkedIn,Professional,49,FALSE,FALSE
ACC055,Company55 Solutions,Logistics,USA,30-07-2022,Referral,Professional,64,FALSE,FALSE
ACC056,Company56 Solutions,Hospitality,Australia,18-05-2023,Website,Professional,62,FALSE,FALSE
ACC057,Company57 Solutions,Education,India,21-08-2023,Google Ads,Professional,59,TRUE,FALSE
ACC058,Company58 Solutions,Cybersecurity,USA,14-11-2023,LinkedIn,Professional,54,FALSE,FALSE
ACC059,Company59 Solutions,Healthcare,UK,27-11-2023,Website,Professional,49,TRUE,FALSE
ACC060,Company60 Solutions,Finance,Singapore,27-11-2023,Referral,Enterprise,141,TRUE,FALSE
ACC061,Company61 Solutions,Agriculture,Netherlands,20-03-2023,Google Ads,Professional,58,FALSE,FALSE
ACC062,Company62 Solutions,Marketing,Canada,07-07-2023,LinkedIn,Basic,8,FALSE,FALSE
ACC063,Company63 Solutions,Finance,USA,03-07-2023,Website,Basic,19,FALSE,FALSE
ACC064,Company64 Solutions,Agriculture,France,28-05-2023,Referral,Enterprise,111,FALSE,FALSE
ACC065,Company65 Solutions,Hospitality,Germany,01-07-2023,Google Ads,Professional,38,FALSE,FALSE
ACC066,Company66 Solutions,Education,UK,27-11-2023,LinkedIn,Professional,46,TRUE,FALSE
ACC067,Company67 Solutions,Education,Australia,26-06-2023,Website,Professional,55,FALSE,TRUE
ACC068,Company68 Solutions,Finance,India,22-06-2023,Referral,Enterprise,131,FALSE,FALSE
ACC069,Company69 Solutions,Hospitality,USA,20-07-2023,Google Ads,Basic,15,FALSE,FALSE
ACC070,Company70 Solutions,Cybersecurity,Netherlands,14-03-2023,LinkedIn,Professional,57,FALSE,FALSE
ACC071,Company71 Solutions,Marketing,Singapore,02-06-2023,Website,Professional,43,TRUE,FALSE
ACC072,Company72 Solutions,Marketing,USA,09-11-2023,Google Ads,Enterprise,142,FALSE,FALSE
ACC073,Company73 Solutions,Cybersecurity,UK,28-11-2023,Referral,Professional,68,TRUE,TRUE
ACC074,Company74 Solutions,Marketing,Canada,26-11-2023,LinkedIn,Basic,8,TRUE,FALSE
ACC075,Company75 Solutions,Construction,Germany,28-11-2023,Website,Enterprise,150,TRUE,FALSE
ACC076,Company76 Solutions,Retail,Australia,27-11-2023,Google Ads,Enterprise,142,FALSE,FALSE
ACC077,Company77 Solutions,Logistics,France,25-11-2023,Referral,Basic,8,FALSE,FALSE
ACC078,Company78 Solutions,Agriculture,India,11-06-2023,LinkedIn,Professional,73,FALSE,TRUE
ACC079,Company79 Solutions,Cybersecurity,USA,21-11-2023,Website,Enterprise,131,FALSE,FALSE
ACC080,Company80 Solutions,Cybersecurity,UK,20-05-2023,Google Ads,Enterprise,142,FALSE,FALSE
ACC081,Company81 Solutions,Logistics,Netherlands,05-07-2023,Referral,Enterprise,144,TRUE,FALSE
ACC082,Company82 Solutions,Cybersecurity,Singapore,24-11-2023,LinkedIn,Professional,73,FALSE,TRUE
ACC083,Company83 Solutions,Logistics,USA,20-07-2023,Website,Enterprise,142,FALSE,FALSE
ACC084,Company84 Solutions,Logistics,Germany,18-06-2023,Google Ads,Professional,43,FALSE,FALSE
ACC085,Company85 Solutions,Hospitality,Australia,21-11-2023,Referral,Professional,46,TRUE,FALSE
ACC086,Company86 Solutions,Finance,Canada,15-10-2023,LinkedIn,Basic,15,FALSE,FALSE
ACC087,Company87 Solutions,Agriculture,France,25-11-2023,Website,Basic,7,FALSE,FALSE
ACC088,Company88 Solutions,Cybersecurity,UK,24-07-2023,Google Ads,Professional,57,FALSE,FALSE
ACC089,Company89 Solutions,Marketing,India,28-11-2023,Referral,Professional,34,TRUE,FALSE
ACC090,Company90 Solutions,Technology,USA,23-10-2023,LinkedIn,Professional,45,FALSE,FALSE
ACC091,Company91 Solutions,Construction,Netherlands,08-11-2023,Website,Professional,77,FALSE,FALSE
ACC092,Company92 Solutions,Agriculture,Singapore,25-10-2023,Google Ads,Basic,11,FALSE,TRUE
ACC093,Company93 Solutions,Hospitality,USA,27-11-2023,Referral,Basic,20,TRUE,FALSE
ACC094,Company94 Solutions,Hospitality,Germany,29-10-2023,LinkedIn,Enterprise,127,FALSE,FALSE
ACC095,Company95 Solutions,Education,Australia,29-09-2023,Website,Basic,6,TRUE,FALSE
ACC096,Company96 Solutions,Healthcare,UK,06-10-2023,Google Ads,Enterprise,163,TRUE,FALSE
ACC097,Company97 Solutions,Agriculture,Canada,27-10-2023,Referral,Basic,20,FALSE,FALSE
ACC098,Company98 Solutions,Marketing,France,24-08-2023,LinkedIn,Basic,23,FALSE,TRUE
ACC099,Company99 Solutions,Finance,India,02-01-2023,Website,Professional,80,FALSE,FALSE
ACC100,Company100 Solutions,Marketing,USA,08-10-2023,Google Ads,Enterprise,144,FALSE,FALSE
ACC101,Company101 Solutions,Technology,Netherlands,12-04-2023,Referral,Professional,46,TRUE,TRUE
ACC102,Company102 Solutions,Healthcare,Singapore,23-10-2023,LinkedIn,Basic,23,FALSE,FALSE
ACC103,Company103 Solutions,Finance,USA,30-10-2023,Website,Enterprise,142,FALSE,FALSE
ACC104,Company104 Solutions,Education,UK,20-07-2023,Google Ads,Enterprise,142,FALSE,FALSE
ACC105,Company105 Solutions,Education,Germany,05-10-2023,Referral,Professional,33,TRUE,FALSE
ACC106,Company106 Solutions,Retail,Australia,22-10-2023,LinkedIn,Enterprise,131,FALSE,FALSE
ACC107,Company107 Solutions,Hospitality,Canada,07-11-2023,Website,Professional,46,TRUE,FALSE
ACC108,Company108 Solutions,Technology,France,02-11-2023,Google Ads,Basic,13,TRUE,FALSE
ACC109,Company109 Solutions,Education,India,15-08-2023,Referral,Basic,21,FALSE,FALSE
ACC110,Company110 Solutions,Cybersecurity,USA,21-10-2023,LinkedIn,Basic,6,FALSE,FALSE
ACC111,Company111 Solutions,Marketing,Netherlands,05-11-2023,Website,Enterprise,144,FALSE,FALSE
ACC112,Company112 Solutions,Healthcare,Singapore,28-11-2023,Google Ads,Professional,39,TRUE,FALSE
ACC113,Company113 Solutions,Construction,UK,19-08-2023,Referral,Basic,6,FALSE,FALSE
ACC114,Company114 Solutions,Technology,USA,04-10-2023,LinkedIn,Basic,6,FALSE,TRUE
ACC115,Company115 Solutions,Finance,Germany,15-11-2023,Website,Enterprise,142,TRUE,FALSE
ACC116,Company116 Solutions,Technology,Australia,20-10-2023,Google Ads,Professional,33,FALSE,FALSE
ACC117,Company117 Solutions,Construction,Canada,30-08-2023,Referral,Professional,49,FALSE,FALSE
ACC118,Company118 Solutions,Cybersecurity,France,11-03-2023,Website,Basic,18,FALSE,FALSE
ACC119,Company119 Solutions,Hospitality,Australia,02-01-2023,Referral,Enterprise,197,FALSE,FALSE
ACC120,Company120 Solutions,Agriculture,France,05-09-2023,Referral,Professional,78,FALSE,FALSE
ACC121,Company121 Solutions,Construction,Canada,24-12-2023,LinkedIn,Professional,44,FALSE,TRUE
ACC122,Company122 Solutions,Agriculture,Netherlands,15-07-2023,Google Ads,Enterprise,191,TRUE,FALSE
ACC123,Company123 Solutions,Technology,India,15-09-2023,Referral,Enterprise,198,FALSE,TRUE
ACC124,Company124 Solutions,Agriculture,USA,15-03-2023,Google Ads,Enterprise,109,TRUE,FALSE
ACC125,Company125 Solutions,Education,Germany,16-11-2023,Google Ads,Professional,51,FALSE,FALSE
ACC126,Company126 Solutions,Logistics,Netherlands,07-09-2023,Website,Professional,45,FALSE,FALSE
ACC127,Company127 Solutions,Retail,Singapore,20-02-2023,LinkedIn,Professional,69,FALSE,FALSE
ACC128,Company128 Solutions,Cybersecurity,UK,14-09-2023,Referral,Basic,5,TRUE,FALSE
ACC129,Company129 Solutions,Finance,USA,10-11-2023,Website,Enterprise,125,FALSE,FALSE
ACC130,Company130 Solutions,Construction,Australia,31-10-2023,Google Ads,Enterprise,131,TRUE,FALSE
ACC131,Company131 Solutions,Technology,Canada,31-10-2023,LinkedIn,Basic,10,FALSE,FALSE
ACC132,Company132 Solutions,Agriculture,France,31-10-2023,Referral,Professional,55,FALSE,FALSE
ACC133,Company133 Solutions,Retail,Germany,12-10-2023,Website,Professional,39,TRUE,FALSE
"""

# Pre-aggregated Usage Data (Derived from raw analysis)
usage_aggregates_csv = """account_id,First usage_date,Features_Used_90D
ACC001,2023-04-18,0
ACC002,2024-05-21,0
ACC003,2024-09-14,0
ACC004,2023-02-04,2
ACC005,2023-03-15,4
ACC006,2023-04-04,2
ACC007,2023-12-13,3
ACC008,2024-01-15,0
ACC009,2023-03-10,1
ACC010,2023-02-23,1
ACC011,2023-09-21,6
ACC012,2023-09-30,1
ACC013,2023-10-10,0
ACC014,2023-12-07,1
ACC015,2023-09-19,1
ACC016,2023-12-01,3
ACC017,2023-09-16,2
ACC018,2023-04-17,1
ACC019,2023-10-10,5
ACC020,2023-08-01,1
ACC021,2023-12-03,3
ACC022,2023-09-30,1
ACC023,2023-08-31,0
ACC024,2023-08-20,2
ACC025,2023-11-20,3
ACC026,2023-11-09,4
ACC027,2023-09-30,1
ACC028,2023-10-30,4
ACC029,2023-10-30,1
ACC030,2023-10-30,5
ACC031,2023-07-22,1
ACC032,2023-12-12,4
ACC033,2023-10-30,4
ACC034,2023-08-30,1
ACC035,2023-09-29,3
ACC036,2023-10-31,3
ACC037,2023-09-27,2
ACC038,2023-08-30,1
ACC039,2023-05-30,3
ACC040,2023-12-30,1
ACC041,2023-09-30,2
ACC042,2023-11-29,4
ACC043,2023-06-30,3
ACC044,2023-05-30,2
ACC045,2023-06-30,5
ACC046,2023-11-30,5
ACC047,2023-08-28,0
ACC048,2023-08-29,0
ACC049,2023-09-29,1
ACC050,2023-11-29,4
ACC051,2023-09-30,2
ACC052,2023-09-05,0
ACC053,2023-12-01,3
ACC054,2023-11-30,4
ACC055,2023-09-29,0
ACC056,2023-08-29,0
ACC057,2023-09-28,2
ACC058,2023-11-29,6
ACC059,2023-11-29,4
ACC060,2023-11-29,4
ACC061,2023-09-09,0
ACC062,2023-08-30,2
ACC063,2023-08-29,3
ACC064,2023-08-30,0
ACC065,2023-08-28,1
ACC066,2023-11-30,4
ACC067,2023-08-29,1
ACC068,2023-08-29,1
ACC069,2023-08-26,2
ACC070,2023-08-30,0
ACC071,2023-08-30,1
ACC072,2023-11-29,4
ACC073,2023-11-29,2
ACC074,2023-11-29,2
ACC075,2023-11-29,3
ACC076,2023-11-29,5
ACC077,2023-11-29,2
ACC078,2023-08-30,1
ACC079,2023-11-29,4
ACC080,2023-08-29,0
ACC081,2023-08-29,3
ACC082,2023-11-29,2
ACC083,2023-08-29,1
ACC084,2023-08-30,1
ACC085,2023-11-29,4
ACC086,2023-11-29,4
ACC087,2023-11-29,4
ACC088,2023-08-29,2
ACC089,2023-11-29,2
ACC090,2023-11-30,2
ACC091,2023-11-29,2
ACC092,2023-11-28,3
ACC093,2023-11-29,5
ACC094,2023-11-29,2
ACC095,2023-11-28,4
ACC096,2023-11-29,1
ACC097,2023-11-29,1
ACC098,2023-11-29,0
ACC099,2023-11-29,0
ACC100,2023-11-29,1
ACC101,2023-11-30,0
ACC102,2023-11-29,2
ACC103,2023-11-28,3
ACC104,2023-11-27,0
ACC105,2023-11-29,0
ACC106,2023-11-29,4
ACC107,2023-11-29,2
ACC108,2023-11-29,2
ACC109,2023-11-29,0
ACC110,2023-11-29,2
ACC111,2023-11-29,3
ACC112,2023-11-29,4
ACC113,2023-11-29,0
ACC114,2023-11-29,1
ACC115,2023-11-29,0
ACC116,2023-11-29,1
ACC117,2023-11-29,1
ACC118,2023-11-29,2
ACC119,2023-06-23,0
ACC120,2023-09-06,3
ACC121,2024-01-05,5
ACC122,2023-11-02,0
ACC123,2023-12-26,0
ACC124,2023-09-17,1
ACC125,2023-11-18,2
ACC126,2023-09-15,2
ACC127,2023-11-27,0
ACC128,2023-10-29,1
ACC129,2023-11-29,3
ACC130,2023-11-28,1
ACC131,2023-11-28,4
ACC132,2023-11-27,4
ACC133,2023-11-29,4
"""

support_csv = """ticket_id,account_id,submitted_at,closed_at,resolution_time_hours,priority,first_response_time_minutes,satisfaction_score,escalation_flag
TIC0001,ACC001,10-03-2023 00:00,10-03-2023 12:00,12,Low,178,4,FALSE
TIC0002,ACC002,30-01-2024 00:00,01-02-2024 22:00,70,High,44,3,TRUE
TIC0003,ACC002,13-12-2023 00:00,13-12-2023 22:00,22,Low,225,3,FALSE
TIC0004,ACC002,05-08-2024 00:00,05-08-2024 10:00,10,Low,102,3,FALSE
TIC0005,ACC003,27-10-2023 00:00,29-10-2023 12:00,60,Critical,18,5,TRUE
TIC0006,ACC003,24-06-2024 00:00,24-06-2024 22:00,22,High,55,4,FALSE
TIC0007,ACC003,13-09-2024 00:00,14-09-2024 14:00,38,Critical,27,3,TRUE
TIC0008,ACC003,13-02-2024 00:00,16-02-2024 10:00,82,High,36,4,FALSE
TIC0009,ACC003,15-08-2024 00:00,17-08-2024 12:00,60,Low,139,3,FALSE
TIC0010,ACC004,18-01-2023 00:00,18-01-2023 19:00,19,Medium,88,2,FALSE
TIC0011,ACC004,19-03-2024 00:00,20-03-2024 12:00,36,Medium,67,1,FALSE
TIC0012,ACC004,24-07-2024 00:00,25-07-2024 19:00,43,Low,238,2,FALSE
TIC0013,ACC004,26-05-2023 00:00,29-05-2023 12:00,84,Low,226,4,FALSE
TIC0014,ACC005,10-09-2024 00:00,13-09-2024 10:00,82,Low,233,4,FALSE
TIC0015,ACC005,29-03-2023 00:00,30-03-2023 16:00,40,Low,100,3,FALSE
TIC0016,ACC005,10-06-2023 00:00,12-06-2023 14:00,62,Low,187,5,FALSE
TIC0017,ACC005,19-09-2024 00:00,22-09-2024 22:00,94,Medium,96,4,FALSE
TIC0018,ACC006,20-09-2024 00:00,20-09-2024 17:00,17,Low,127,5,FALSE
TIC0019,ACC007,09-12-2023 00:00,10-12-2023 05:00,17,High,57,4,FALSE
TIC0020,ACC007,17-06-2024 00:00,17-06-2024 19:00,19,Medium,71,4,FALSE
TIC0021,ACC007,24-03-2024 00:00,25-03-2024 14:00,38,Critical,27,4,TRUE
TIC0022,ACC007,13-09-2024 00:00,14-09-2024 19:00,43,Low,236,4,FALSE
TIC0023,ACC008,12-10-2023 00:00,12-10-2023 19:00,19,Low,222,5,FALSE
TIC0024,ACC009,17-04-2023 00:00,17-04-2023 05:00,5,Medium,98,5,FALSE
TIC0025,ACC009,19-09-2024 00:00,20-09-2024 17:00,41,Low,170,4,FALSE
TIC0026,ACC010,22-02-2023 00:00,22-02-2023 23:00,23,Low,198,5,FALSE
TIC0027,ACC010,27-08-2024 00:00,28-08-2024 10:00,34,Medium,65,3,FALSE
TIC0028,ACC010,13-05-2024 00:00,14-05-2024 14:00,38,Low,223,4,FALSE
TIC0029,ACC011,28-08-2023 00:00,28-08-2023 21:00,21,Low,210,3,FALSE
TIC0030,ACC011,20-06-2024 00:00,21-06-2024 10:00,34,Critical,23,4,FALSE
TIC0031,ACC011,29-07-2024 00:00,01-08-2024 22:00,94,Critical,16,4,TRUE
TIC0032,ACC012,24-03-2024 00:00,25-03-2024 10:00,34,Low,147,5,FALSE
TIC0033,ACC012,19-09-2024 00:00,22-09-2024 12:00,84,Low,229,5,FALSE
TIC0034,ACC013,11-06-2023 00:00,12-06-2023 10:00,34,High,44,4,FALSE
TIC0035,ACC013,12-05-2023 00:00,12-05-2023 05:00,5,Medium,90,5,FALSE
TIC0036,ACC013,29-08-2024 00:00,30-08-2024 22:00,46,Medium,99,3,FALSE
TIC0037,ACC014,13-09-2023 00:00,13-09-2023 10:00,10,Low,237,3,FALSE
TIC0038,ACC014,14-06-2024 00:00,16-06-2024 22:00,70,Low,220,1,FALSE
TIC0039,ACC014,24-01-2024 00:00,27-01-2024 12:00,84,Critical,19,2,TRUE
TIC0040,ACC015,22-07-2023 00:00,23-07-2023 01:00,25,Low,170,2,FALSE
TIC0041,ACC015,27-07-2024 00:00,29-07-2024 14:00,62,Low,229,4,FALSE
TIC0042,ACC016,06-12-2023 00:00,06-12-2023 18:00,18,Medium,83,5,FALSE
TIC0043,ACC016,23-07-2024 00:00,24-07-2024 22:00,46,Critical,27,5,TRUE
TIC0044,ACC017,21-08-2023 00:00,23-08-2023 09:00,57,Low,198,5,FALSE
TIC0045,ACC017,29-03-2024 00:00,30-03-2024 19:00,43,Low,239,5,FALSE
TIC0046,ACC017,17-06-2024 00:00,18-06-2024 22:00,46,Low,192,5,FALSE
TIC0047,ACC018,29-03-2023 00:00,31-03-2023 09:00,57,Low,147,2,FALSE
TIC0048,ACC019,10-10-2023 00:00,12-10-2023 17:00,65,High,41,2,TRUE
TIC0049,ACC019,27-01-2024 00:00,27-01-2024 10:00,10,High,33,2,FALSE
TIC0050,ACC020,13-06-2023 00:00,14-06-2023 19:00,43,Medium,80,2,FALSE
TIC0051,ACC020,18-08-2023 00:00,19-08-2023 05:00,29,Low,165,2,FALSE
TIC0052,ACC021,02-12-2023 00:00,02-12-2023 12:00,12,Medium,97,5,FALSE
TIC0053,ACC021,29-12-2023 00:00,29-12-2023 05:00,5,Low,184,5,FALSE
TIC0054,ACC021,29-07-2024 00:00,30-07-2024 14:00,38,Critical,27,5,FALSE
TIC0055,ACC022,23-08-2023 00:00,23-08-2023 18:00,18,Low,233,5,FALSE
TIC0056,ACC022,23-08-2023 00:00,25-08-2023 10:00,58,Low,230,5,FALSE
TIC0057,ACC022,17-06-2024 00:00,19-06-2024 12:00,60,Low,133,5,FALSE
TIC0058,ACC023,01-08-2023 00:00,02-08-2023 17:00,41,Low,133,3,FALSE
TIC0059,ACC023,10-06-2023 00:00,10-06-2023 17:00,17,Low,167,4,FALSE
TIC0060,ACC023,20-03-2024 00:00,23-03-2024 14:00,86,Low,212,5,FALSE
TIC0061,ACC024,20-06-2024 00:00,22-06-2024 10:00,58,Low,237,3,FALSE
TIC0062,ACC025,16-11-2023 00:00,17-11-2023 17:00,41,Low,129,5,FALSE
TIC0063,ACC025,23-12-2023 00:00,23-12-2023 12:00,12,Low,212,5,FALSE
TIC0064,ACC025,27-11-2023 00:00,27-11-2023 05:00,5,Low,220,5,FALSE
TIC0065,ACC026,20-02-2024 00:00,21-02-2024 19:00,43,Medium,87,1,FALSE
TIC0066,ACC027,24-09-2023 00:00,26-09-2023 19:00,67,Low,205,4,FALSE
TIC0067,ACC028,09-10-2023 00:00,09-10-2023 10:00,10,Low,225,5,FALSE
TIC0068,ACC029,20-06-2024 00:00,21-06-2024 12:00,36,High,37,3,FALSE
TIC0069,ACC030,22-06-2024 00:00,23-06-2024 19:00,43,Low,230,3,FALSE
TIC0070,ACC031,23-09-2023 00:00,25-09-2023 17:00,65,High,35,1,TRUE
TIC0071,ACC031,27-02-2024 00:00,27-02-2024 17:00,17,Low,210,1,FALSE
TIC0072,ACC032,12-12-2023 00:00,12-12-2023 12:00,12,Low,127,2,FALSE
TIC0073,ACC032,23-05-2024 00:00,24-05-2024 22:00,46,Medium,92,2,FALSE
TIC0074,ACC033,28-10-2023 00:00,31-10-2023 10:00,82,High,41,4,FALSE
TIC0075,ACC034,22-08-2023 00:00,23-08-2023 12:00,36,High,48,2,FALSE
TIC0076,ACC034,27-08-2023 00:00,27-08-2023 05:00,5,Low,133,3,FALSE
TIC0077,ACC035,22-05-2024 00:00,24-05-2024 22:00,70,Medium,96,3,FALSE
TIC0078,ACC036,30-10-2023 00:00,30-10-2023 09:00,9,High,49,3,FALSE
TIC0079,ACC036,29-02-2024 00:00,02-03-2024 10:00,58,Low,237,3,FALSE
TIC0080,ACC037,13-05-2024 00:00,14-05-2024 22:00,46,Medium,94,3,FALSE
TIC0081,ACC038,15-08-2023 00:00,17-08-2023 18:00,66,Critical,27,2,TRUE
TIC0082,ACC038,15-07-2023 00:00,17-07-2023 17:00,65,Critical,20,3,TRUE
TIC0083,ACC039,22-04-2023 00:00,23-04-2023 17:00,41,Low,223,4,FALSE
TIC0084,ACC039,12-05-2023 00:00,12-05-2023 05:00,5,Low,232,4,FALSE
TIC0085,ACC040,16-06-2024 00:00,18-06-2024 22:00,70,Low,210,5,FALSE
TIC0086,ACC041,20-03-2024 00:00,21-03-2024 17:00,41,Low,127,4,FALSE
TIC0087,ACC042,21-11-2023 00:00,24-11-2023 05:00,53,Critical,19,2,TRUE
TIC0088,ACC043,15-06-2023 00:00,18-06-2023 22:00,94,High,41,1,TRUE
TIC0089,ACC044,19-06-2024 00:00,21-06-2024 19:00,67,Low,237,3,FALSE
TIC0090,ACC045,15-06-2023 00:00,17-06-2023 22:00,70,High,37,1,TRUE
TIC0091,ACC046,24-11-2023 00:00,24-11-2023 05:00,5,Low,129,4,FALSE
TIC0092,ACC047,15-08-2023 00:00,16-08-2023 10:00,34,High,37,4,FALSE
TIC0093,ACC047,19-06-2023 00:00,20-06-2023 05:00,29,Medium,84,3,FALSE
TIC0094,ACC048,15-08-2023 00:00,17-08-2023 17:00,65,High,44,4,FALSE
TIC0095,ACC048,22-07-2023 00:00,22-07-2023 12:00,12,Low,170,4,FALSE
TIC0096,ACC049,15-06-2024 00:00,16-06-2024 22:00,46,Medium,92,5,FALSE
TIC0097,ACC050,26-11-2023 00:00,26-11-2023 05:00,5,Low,184,4,FALSE
TIC0098,ACC051,19-03-2024 00:00,20-03-2024 19:00,43,Low,210,4,FALSE
TIC0099,ACC052,19-09-2024 00:00,20-09-2024 17:00,41,Low,210,3,FALSE
TIC0100,ACC053,30-11-2023 00:00,30-11-2023 05:00,5,Low,127,5,FALSE
TIC0101,ACC054,26-11-2023 00:00,28-11-2023 12:00,60,Low,225,5,FALSE
TIC0102,ACC054,27-12-2023 00:00,28-12-2023 12:00,36,Medium,84,5,FALSE
TIC0103,ACC055,16-06-2023 00:00,19-06-2023 22:00,94,Low,147,5,FALSE
TIC0104,ACC056,23-08-2023 00:00,24-08-2023 22:00,46,Low,236,3,FALSE
TIC0105,ACC056,20-06-2023 00:00,20-06-2023 12:00,12,Low,133,3,FALSE
TIC0106,ACC057,21-08-2023 00:00,24-08-2023 05:00,77,Medium,94,3,FALSE
TIC0107,ACC058,16-11-2023 00:00,18-11-2023 17:00,65,Medium,94,4,FALSE
TIC0108,ACC058,17-11-2023 00:00,18-11-2023 10:00,34,Low,198,4,FALSE
TIC0109,ACC059,28-11-2023 00:00,01-12-2023 22:00,94,Medium,92,2,TRUE
TIC0110,ACC059,28-11-2023 00:00,01-12-2023 19:00,91,High,48,2,TRUE
TIC0111,ACC060,19-06-2024 00:00,20-06-2024 14:00,38,Critical,27,2,TRUE
TIC0112,ACC061,16-06-2023 00:00,17-06-2023 22:00,46,Medium,96,5,FALSE
TIC0113,ACC062,23-08-2023 00:00,23-08-2023 17:00,17,Low,184,3,FALSE
TIC0114,ACC063,03-07-2023 00:00,03-07-2023 05:00,5,Low,170,4,FALSE
TIC0115,ACC064,28-05-2023 00:00,29-05-2023 17:00,41,Low,237,5,FALSE
TIC0116,ACC065,02-07-2023 00:00,04-07-2023 12:00,60,Low,210,5,FALSE
TIC0117,ACC066,27-11-2023 00:00,27-11-2023 05:00,5,Low,236,1,FALSE
TIC0118,ACC067,26-06-2023 00:00,27-06-2023 10:00,34,Low,133,2,FALSE
TIC0119,ACC068,22-06-2023 00:00,23-06-2023 17:00,41,Low,133,3,FALSE
TIC0120,ACC068,26-08-2023 00:00,30-08-2023 19:00,115,High,37,3,TRUE
TIC0121,ACC069,20-07-2023 00:00,23-07-2023 05:00,77,Low,147,4,FALSE
TIC0122,ACC070,23-03-2024 00:00,25-03-2024 22:00,70,Low,129,5,FALSE
TIC0123,ACC071,20-03-2024 00:00,21-03-2024 22:00,46,Medium,90,5,FALSE
TIC0124,ACC072,20-06-2024 00:00,22-06-2024 22:00,70,Medium,84,5,FALSE
TIC0125,ACC073,28-11-2023 00:00,30-11-2023 17:00,65,High,35,1,TRUE
TIC0126,ACC073,30-11-2023 00:00,04-12-2023 19:00,115,High,48,1,TRUE
TIC0127,ACC074,26-11-2023 00:00,28-11-2023 17:00,65,Medium,98,3,FALSE
TIC0128,ACC075,28-11-2023 00:00,28-11-2023 05:00,5,Low,237,3,FALSE
TIC0129,ACC076,27-11-2023 00:00,27-11-2023 05:00,5,Low,198,4,FALSE
TIC0130,ACC077,25-11-2023 00:00,26-11-2023 05:00,29,Low,232,4,FALSE
TIC0131,ACC078,16-09-2024 00:00,18-09-2024 10:00,58,High,41,1,TRUE
TIC0132,ACC079,21-11-2023 00:00,22-11-2023 05:00,29,Low,184,3,FALSE
TIC0133,ACC079,24-11-2023 00:00,24-11-2023 12:00,12,Low,133,3,FALSE
TIC0134,ACC079,27-11-2023 00:00,28-11-2023 17:00,41,Low,210,3,FALSE
TIC0135,ACC080,24-03-2024 00:00,25-03-2024 19:00,43,Low,236,4,FALSE
TIC0136,ACC081,05-07-2023 00:00,05-07-2023 05:00,5,Medium,84,4,FALSE
TIC0137,ACC082,24-11-2023 00:00,24-11-2023 05:00,5,Low,165,2,FALSE
TIC0138,ACC083,20-07-2023 00:00,23-07-2023 05:00,77,Low,225,3,FALSE
TIC0139,ACC084,20-03-2024 00:00,21-03-2024 14:00,38,Medium,92,5,FALSE
TIC0140,ACC085,22-11-2023 00:00,22-11-2023 05:00,5,Low,133,3,FALSE
TIC0141,ACC086,15-10-2023 00:00,15-10-2023 05:00,5,Low,222,4,FALSE
TIC0142,ACC087,25-11-2023 00:00,26-11-2023 05:00,29,Low,133,4,FALSE
TIC0143,ACC088,24-07-2023 00:00,26-07-2023 17:00,65,Low,184,3,FALSE
TIC0144,ACC089,28-11-2023 00:00,29-11-2023 22:00,46,Medium,90,3,FALSE
TIC0145,ACC090,23-10-2023 00:00,23-10-2023 05:00,5,Low,233,4,FALSE
TIC0146,ACC091,08-11-2023 00:00,08-11-2023 05:00,5,Low,212,4,FALSE
TIC0147,ACC092,26-10-2023 00:00,28-10-2023 12:00,60,Low,233,2,FALSE
TIC0148,ACC093,27-11-2023 00:00,27-11-2023 05:00,5,Low,225,3,FALSE
TIC0149,ACC094,29-10-2023 00:00,30-10-2023 10:00,34,High,41,4,FALSE
TIC0150,ACC095,29-09-2023 00:00,30-09-2023 17:00,41,Low,232,4,FALSE
TIC0151,ACC095,27-11-2023 00:00,28-11-2023 12:00,36,Medium,99,4,FALSE
TIC0152,ACC096,06-10-2023 00:00,06-10-2023 05:00,5,Low,133,4,FALSE
TIC0153,ACC097,27-10-2023 00:00,27-10-2023 05:00,5,Low,147,5,FALSE
TIC0154,ACC098,24-08-2023 00:00,25-08-2023 17:00,41,Low,210,1,FALSE
TIC0155,ACC099,23-09-2023 00:00,24-09-2023 10:00,34,Medium,83,4,FALSE
TIC0156,ACC100,08-10-2023 00:00,08-10-2023 05:00,5,Low,222,4,FALSE
TIC0157,ACC101,12-04-2023 00:00,12-04-2023 05:00,5,Low,229,2,FALSE
TIC0158,ACC102,23-10-2023 00:00,23-10-2023 05:00,5,Low,210,5,FALSE
TIC0159,ACC103,30-10-2023 00:00,31-10-2023 22:00,46,Medium,80,4,FALSE
TIC0160,ACC103,28-11-2023 00:00,30-11-2023 10:00,58,Low,236,4,FALSE
TIC0161,ACC104,20-07-2023 00:00,20-07-2023 05:00,5,Low,237,3,FALSE
TIC0162,ACC105,05-10-2023 00:00,07-10-2023 17:00,65,Medium,92,4,FALSE
TIC0163,ACC106,22-10-2023 00:00,22-10-2023 05:00,5,Low,127,4,FALSE
TIC0164,ACC107,07-11-2023 00:00,07-11-2023 05:00,5,Low,230,4,FALSE
TIC0165,ACC108,02-11-2023 00:00,02-11-2023 05:00,5,Low,210,4,FALSE
TIC0166,ACC109,15-08-2023 00:00,15-08-2023 05:00,5,Low,229,2,FALSE
TIC0167,ACC110,21-10-2023 00:00,24-10-2023 17:00,89,Critical,19,4,TRUE
TIC0168,ACC110,27-11-2023 00:00,28-11-2023 22:00,46,Low,220,4,FALSE
TIC0169,ACC111,05-11-2023 00:00,06-11-2023 17:00,41,Low,220,4,FALSE
TIC0170,ACC112,28-11-2023 00:00,28-11-2023 05:00,5,Low,147,3,FALSE
TIC0171,ACC113,19-08-2023 00:00,20-08-2023 10:00,34,High,48,5,FALSE
TIC0172,ACC114,04-10-2023 00:00,06-10-2023 10:00,58,Low,237,3,FALSE
TIC0173,ACC115,15-11-2023 00:00,18-11-2023 10:00,82,Low,184,3,FALSE
TIC0174,ACC115,28-11-2023 00:00,29-11-2023 17:00,41,Low,192,3,FALSE
TIC0175,ACC116,20-10-2023 00:00,20-10-2023 05:00,5,Low,127,4,FALSE
TIC0176,ACC117,30-08-2023 00:00,02-09-2023 17:00,89,Low,133,1,FALSE
TIC0177,ACC117,29-11-2023 00:00,30-11-2023 17:00,41,High,36,1,TRUE
TIC0178,ACC118,05-11-2023 00:00,07-11-2023 10:00,58,Low,184,4,FALSE
TIC0179,ACC119,20-03-2024 00:00,21-03-2024 14:00,38,Medium,96,4,FALSE
TIC0180,ACC120,20-09-2024 00:00,22-09-2024 12:00,84,Low,210,3,FALSE
TIC0181,ACC121,29-07-2024 00:00,29-07-2024 05:00,5,Low,237,2,FALSE
TIC0182,ACC122,23-03-2024 00:00,24-03-2024 14:00,38,Low,210,3,FALSE
TIC0183,ACC123,24-03-2024 00:00,24-03-2024 22:00,22,High,41,1,FALSE
TIC0184,ACC124,19-09-2024 00:00,20-09-2024 10:00,34,Low,232,4,FALSE
TIC0185,ACC125,19-09-2024 00:00,19-09-2024 05:00,5,Low,127,4,FALSE
TIC0186,ACC126,20-09-2024 00:00,22-09-2024 22:00,94,Medium,94,2,FALSE
TIC0187,ACC126,27-08-2024 00:00,29-08-2024 10:00,58,Low,170,2,FALSE
TIC0188,ACC127,24-03-2024 00:00,24-03-2024 05:00,5,Low,230,5,FALSE
TIC0189,ACC128,29-07-2024 00:00,31-07-2024 17:00,89,Low,198,3,FALSE
TIC0190,ACC129,19-06-2024 00:00,21-06-2024 22:00,94,Low,129,3,FALSE
TIC0191,ACC129,28-11-2023 00:00,29-11-2023 22:00,46,Medium,96,3,FALSE
TIC0192,ACC130,28-11-2023 00:00,29-11-2023 10:00,34,Medium,80,4,FALSE
TIC0193,ACC131,28-11-2023 00:00,28-11-2023 05:00,5,Low,147,3,FALSE
TIC0194,ACC132,27-11-2023 00:00,27-11-2023 05:00,5,Low,229,4,FALSE
TIC0195,ACC133,28-11-2023 00:00,28-11-2023 05:00,5,Low,236,5,FALSE
"""

churn_csv = """churn_event_id,account_id,churn_date,reason_code,refund_amount_usd,preceding_upgrade_flag,preceding_downgrade_flag,is_reactivation,feedback_text
CHRN001,ACC004,2024-12-06,Budget Constraints,1144.72,False,False,False,Internal budget cuts forced us to discontinue.
CHRN002,ACC014,2025-08-21,Missing Features,4648.51,False,False,False,Some key features required for our workflow were missing.
CHRN003,ACC018,2025-02-02,Pricing Issues,3582.13,False,False,False,The pricing became too expensive for our current scale.
CHRN004,ACC019,2024-03-05,Pricing Issues,941.99,False,False,False,The pricing became too expensive for our current scale.
CHRN005,ACC020,2023-11-24,Company Shutdown,112.03,False,False,True,We had to shut down operations this quarter.
CHRN006,ACC026,2024-02-28,Low Product Adoption,7228.31,False,False,False,Our team was not fully utilizing the platform features.
CHRN007,ACC031,2025-07-22,Low Product Adoption,1033.31,False,False,False,Our team was not fully utilizing the platform features.
CHRN008,ACC073,2024-05-18,Missing Features,1769.91,False,False,False,Some key features required for our workflow were missing.
CHRN009,ACC078,2025-02-27,Missing Features,2281.63,False,False,False,Some key features required for our workflow were missing.
CHRN010,ACC082,2024-01-18,Pricing Issues,625.23,False,False,False,The pricing became too expensive for our current scale.
CHRN011,ACC092,2023-11-10,Company Shutdown,205.0,False,False,True,We had to shut down operations this quarter.
CHRN012,ACC098,2024-01-22,Pricing Issues,196.07,False,False,False,The pricing became too expensive for our current scale.
CHRN013,ACC101,2024-02-11,Low Product Adoption,1659.85,False,False,True,Our team was not fully utilizing the platform features.
CHRN014,ACC114,2025-05-04,Low Product Adoption,88.92,False,False,False,Our team was not fully utilizing the platform features.
CHRN015,ACC121,2024-12-18,Switched to Competitor,889.35,False,False,False,We found a competitor offering better value.
CHRN016,ACC123,2024-09-13,Switched to Competitor,5109.91,False,False,False,We found a competitor offering better value.
"""

nps_csv = """account_id,account_name,industry,signup_date,plan_tier,mrr,is_active,churn_flag,nps_score,nps_category,relationship_csat_score,churn_date,reason_code
ACC001,Company1 Solutions,Logistics,2023-01-13,Basic,180,True,False,9,Promoter,4,,
ACC002,Company2 Solutions,Hospitality,2023-10-30,Basic,140,True,False,8,Passive,4,,
ACC003,Company3 Solutions,Cybersecurity,2023-10-15,Enterprise,17900,True,False,6,Detractor,4,,
ACC004,Company4 Solutions,Cybersecurity,2023-01-04,Professional,2550,False,True,3,Detractor,2,2024-12-06,Budget Constraints
ACC005,Company5 Solutions,Construction,2023-02-17,Basic,320,True,False,9,Promoter,4,,
ACC006,Company6 Solutions,Agriculture,2023-03-05,Basic,280,True,False,9,Promoter,5,,
ACC007,Company7 Solutions,Retail,2023-12-05,Enterprise,10000,True,False,9,Promoter,4,,
ACC008,Company8 Solutions,Marketing,2023-08-21,Basic,320,True,False,9,Promoter,5,,
ACC009,Company9 Solutions,Logistics,2023-02-06,Professional,2250,True,False,8,Passive,5,,
ACC010,Company10 Solutions,Education,2023-01-23,Professional,3950,True,False,8,Passive,5,,
ACC011,Company11 Solutions,Technology,2023-08-27,Basic,220,True,False,8,Passive,4,,
ACC012,Company12 Solutions,Agriculture,2023-08-23,Basic,180,True,False,10,Promoter,5,,
ACC013,Company13 Solutions,Hospitality,2023-05-11,Enterprise,14100,True,False,6,Detractor,4,,
ACC014,Company14 Solutions,Healthcare,2023-09-10,Enterprise,20000,False,True,0,Detractor,2,2025-08-21,Missing Features
ACC015,Company15 Solutions,Healthcare,2023-07-18,Professional,2700,True,False,6,Detractor,3,,
ACC016,Company16 Solutions,Agriculture,2023-11-20,Professional,1850,True,False,9,Promoter,5,,
ACC017,Company17 Solutions,Construction,2023-07-21,Basic,100,True,False,9,Promoter,5,,
ACC018,Company18 Solutions,Healthcare,2023-02-24,Enterprise,15400,False,True,2,Detractor,2,2025-02-02,Pricing Issues
ACC019,Company19 Solutions,Healthcare,2023-09-29,Professional,3050,False,True,2,Detractor,2,2024-03-05,Pricing Issues
ACC020,Company20 Solutions,Construction,2023-06-07,Basic,460,False,True,1,Detractor,2,2023-11-24,Company Shutdown
ACC021,Company21 Solutions,Agriculture,2023-11-29,Basic,400,True,False,9,Promoter,5,,
ACC022,Company22 Solutions,Cybersecurity,2023-08-07,Enterprise,14100,True,False,8,Passive,5,,
ACC023,Company23 Solutions,Hospitality,2023-06-01,Basic,300,True,False,8,Passive,4,,
ACC024,Company24 Solutions,Finance,2023-07-19,Basic,500,True,False,8,Passive,3,,
ACC025,Company25 Solutions,Technology,2023-11-14,Basic,400,True,False,8,Passive,5,,
ACC026,Company26 Solutions,Cybersecurity,2023-10-29,Enterprise,19300,False,True,2,Detractor,1,2024-02-28,Low Product Adoption
ACC027,Company27 Solutions,Retail,2023-08-06,Professional,2950,True,False,10,Promoter,4,,
ACC028,Company28 Solutions,Logistics,2023-10-01,Enterprise,19200,True,False,10,Promoter,5,,
ACC029,Company29 Solutions,Finance,2023-09-06,Professional,2350,True,False,8,Passive,3,,
ACC030,Company30 Solutions,Retail,2023-10-20,Basic,440,True,False,7,Passive,3,,
ACC031,Company31 Solutions,Finance,2023-05-23,Professional,2750,False,True,4,Detractor,1,2025-07-22,Low Product Adoption
ACC032,Company32 Solutions,Technology,2023-12-12,Basic,440,True,False,3,Detractor,2,,
ACC033,Company33 Solutions,Education,2023-10-28,Enterprise,9700,True,False,8,Passive,4,,
ACC034,Company34 Solutions,Hospitality,2023-06-17,Enterprise,10000,True,False,3,Detractor,2,,
ACC035,Company35 Solutions,Retail,2023-08-28,Basic,460,True,False,6,Detractor,3,,
ACC036,Company36 Solutions,Technology,2023-10-30,Professional,3300,True,False,8,Passive,3,,
ACC037,Company37 Solutions,Finance,2023-07-28,Basic,180,True,False,6,Detractor,3,,
ACC038,Company38 Solutions,Retail,2023-06-15,Basic,220,True,False,3,Detractor,2,,
ACC039,Company39 Solutions,Construction,2023-04-10,Basic,380,True,False,9,Promoter,4,,
ACC040,Company40 Solutions,Logistics,2023-12-11,Enterprise,10300,True,False,10,Promoter,5,,
ACC041,Company41 Solutions,Retail,2023-09-04,Basic,480,True,False,6,Detractor,4,,
ACC042,Company42 Solutions,Finance,2023-11-20,Professional,2300,True,False,0,Detractor,2,,
ACC043,Company43 Solutions,Marketing,2023-05-24,Professional,1900,True,False,1,Detractor,1,,
ACC044,Company44 Solutions,Agriculture,2023-04-10,Professional,1850,True,False,8,Passive,3,,
ACC045,Company45 Solutions,Healthcare,2023-06-07,Professional,1950,True,False,1,Detractor,1,,
ACC046,Company46 Solutions,Education,2023-11-24,Basic,240,True,False,10,Promoter,4,,
ACC047,Company47 Solutions,Hospitality,2023-05-12,Enterprise,12000,True,False,8,Passive,4,,
ACC048,Company48 Solutions,Healthcare,2023-05-05,Enterprise,13200,True,False,8,Passive,4,,
ACC049,Company49 Solutions,Finance,2023-08-29,Professional,2150,True,False,10,Promoter,5,,
ACC050,Company50 Solutions,Agriculture,2023-11-25,Basic,300,True,False,10,Promoter,4,,
ACC051,Company51 Solutions,Retail,2023-09-04,Professional,2150,True,False,8,Passive,4,,
ACC052,Company52 Solutions,Retail,2023-01-21,Basic,260,True,False,8,Passive,3,,
ACC053,Company53 Solutions,Construction,2023-11-30,Professional,2000,True,False,8,Passive,5,,
ACC054,Company54 Solutions,Marketing,2023-11-26,Professional,2450,True,False,9,Promoter,5,,
ACC055,Company55 Solutions,Logistics,2022-07-30,Professional,3200,True,False,10,Promoter,5,,
ACC056,Company56 Solutions,Hospitality,2023-05-18,Professional,3100,True,False,8,Passive,3,,
ACC057,Company57 Solutions,Education,2023-08-21,Professional,2950,True,False,7,Passive,3,,
ACC058,Company58 Solutions,Cybersecurity,2023-11-14,Professional,2700,True,False,6,Detractor,4,,
ACC059,Company59 Solutions,Healthcare,2023-11-27,Professional,2450,True,False,3,Detractor,2,,
ACC060,Company60 Solutions,Finance,2023-11-27,Enterprise,14100,True,False,0,Detractor,2,,
ACC061,Company61 Solutions,Agriculture,2023-03-20,Professional,2900,True,False,10,Promoter,5,,
ACC062,Company62 Solutions,Marketing,2023-07-07,Basic,160,True,False,6,Detractor,3,,
ACC063,Company63 Solutions,Finance,2023-07-03,Basic,380,True,False,9,Promoter,4,,
ACC064,Company64 Solutions,Agriculture,2023-05-28,Enterprise,11100,True,False,9,Promoter,5,,
ACC065,Company65 Solutions,Hospitality,2023-07-01,Professional,1900,True,False,9,Promoter,5,,
ACC066,Company66 Solutions,Education,2023-11-27,Professional,2300,True,False,1,Detractor,1,,
ACC067,Company67 Solutions,Education,2023-06-26,Professional,2750,False,True,1,Detractor,2,2025-05-10,Low Product Adoption
ACC068,Company68 Solutions,Finance,2023-06-22,Enterprise,13100,True,False,5,Detractor,3,,
ACC069,Company69 Solutions,Hospitality,2023-07-20,Basic,300,True,False,9,Promoter,4,,
ACC070,Company70 Solutions,Cybersecurity,2023-03-14,Professional,2850,True,False,10,Promoter,5,,
ACC071,Company71 Solutions,Marketing,2023-06-02,Professional,2150,True,False,7,Passive,5,,
ACC072,Company72 Solutions,Marketing,2023-11-09,Enterprise,14200,True,False,8,Passive,5,,
ACC073,Company73 Solutions,Cybersecurity,2023-11-28,Professional,3400,False,True,4,Detractor,1,2025-01-12,Company Shutdown
ACC074,Company74 Solutions,Marketing,2023-11-26,Basic,160,True,False,7,Passive,3,,
ACC075,Company75 Solutions,Construction,2023-11-28,Enterprise,15000,True,False,7,Passive,3,,
ACC076,Company76 Solutions,Retail,2023-11-27,Enterprise,14200,True,False,8,Passive,4,,
ACC077,Company77 Solutions,Logistics,2023-11-25,Basic,160,True,False,9,Promoter,4,,
ACC078,Company78 Solutions,Agriculture,2023-06-11,Professional,3650,False,True,0,Detractor,1,2025-02-27,Missing Features
ACC079,Company79 Solutions,Cybersecurity,2023-11-21,Enterprise,13100,True,False,5,Detractor,3,,
ACC080,Company80 Solutions,Cybersecurity,2023-05-20,Enterprise,14200,True,False,8,Passive,4,,
ACC081,Company81 Solutions,Logistics,2023-07-05,Enterprise,14400,True,False,6,Detractor,4,,
ACC082,Company82 Solutions,Cybersecurity,2023-11-24,Professional,3650,False,True,3,Detractor,2,2024-01-18,Pricing Issues
ACC083,Company83 Solutions,Logistics,2023-07-20,Enterprise,14200,True,False,8,Passive,3,,
ACC084,Company84 Solutions,Logistics,2023-06-18,Professional,2150,True,False,9,Promoter,5,,
ACC085,Company85 Solutions,Hospitality,2023-11-21,Professional,2300,True,False,6,Detractor,3,,
ACC086,Company86 Solutions,Finance,2023-10-15,Basic,300,True,False,9,Promoter,4,,
ACC087,Company87 Solutions,Agriculture,2023-11-25,Basic,140,True,False,8,Passive,4,,
ACC088,Company88 Solutions,Cybersecurity,2023-07-24,Professional,2850,True,False,6,Detractor,3,,
ACC089,Company89 Solutions,Marketing,2023-11-28,Professional,1700,True,False,8,Passive,3,,
ACC090,Company90 Solutions,Technology,2023-10-23,Professional,2250,True,False,9,Promoter,4,,
ACC091,Company91 Solutions,Construction,2023-11-08,Professional,3850,True,False,6,Detractor,4,,
ACC092,Company92 Solutions,Agriculture,2023-10-25,Basic,220,False,True,4,Detractor,2,2023-11-10,Company Shutdown
ACC093,Company93 Solutions,Hospitality,2023-11-27,Basic,400,True,False,8,Passive,3,,
ACC094,Company94 Solutions,Hospitality,2023-10-29,Enterprise,12700,True,False,10,Promoter,4,,
ACC095,Company95 Solutions,Education,2023-09-29,Basic,120,True,False,6,Detractor,4,,
ACC096,Company96 Solutions,Healthcare,2023-10-06,Enterprise,16300,True,False,8,Passive,4,,
ACC097,Company97 Solutions,Agriculture,2023-10-27,Basic,400,True,False,10,Promoter,5,,
ACC098,Company98 Solutions,Marketing,2023-08-24,Basic,460,False,True,2,Detractor,1,2024-01-22,Pricing Issues
ACC099,Company99 Solutions,Finance,2023-01-02,Professional,4000,True,False,7,Passive,4,,
ACC100,Company100 Solutions,Marketing,2023-10-08,Enterprise,14400,True,False,8,Passive,4,,
ACC101,Company101 Solutions,Technology,2023-04-12,Professional,2300,False,True,3,Detractor,2,2024-02-11,Low Product Adoption
ACC102,Company102 Solutions,Healthcare,2023-10-23,Basic,460,True,False,9,Promoter,5,,
ACC103,Company103 Solutions,Finance,2023-10-30,Enterprise,14200,True,False,7,Passive,4,,
ACC104,Company104 Solutions,Education,2023-07-20,Enterprise,14200,True,False,6,Detractor,3,,
ACC105,Company105 Solutions,Education,2023-10-05,Professional,1650,True,False,9,Promoter,4,,
ACC106,Company106 Solutions,Retail,2023-10-22,Enterprise,13100,True,False,9,Promoter,4,,
ACC107,Company107 Solutions,Hospitality,2023-11-07,Professional,2300,True,False,6,Detractor,4,,
ACC108,Company108 Solutions,Technology,2023-11-02,Basic,260,True,False,7,Passive,4,,
ACC109,Company109 Solutions,Education,2023-08-15,Basic,420,True,False,4,Detractor,2,,
ACC110,Company110 Solutions,Cybersecurity,2023-10-21,Basic,120,True,False,6,Detractor,4,,
ACC111,Company111 Solutions,Marketing,2023-11-05,Enterprise,14400,True,False,8,Passive,4,,
ACC112,Company112 Solutions,Healthcare,2023-11-28,Professional,1950,True,False,8,Passive,3,,
ACC113,Company113 Solutions,Construction,2023-08-19,Basic,120,True,False,9,Promoter,5,,
ACC114,Company114 Solutions,Technology,2023-10-04,Basic,120,False,True,6,Detractor,3,2025-05-04,Low Product Adoption
ACC115,Company115 Solutions,Finance,2023-11-15,Enterprise,14200,True,False,8,Passive,3,,
ACC116,Company116 Solutions,Technology,2023-10-20,Professional,1650,True,False,6,Detractor,4,,
ACC117,Company117 Solutions,Construction,2023-08-30,Professional,2450,True,False,3,Detractor,1,,
ACC118,Company118 Solutions,Cybersecurity,2023-03-11,Basic,360,True,False,8,Passive,4,,
ACC119,Company119 Solutions,Hospitality,2023-01-02,Enterprise,19700,True,False,7,Passive,4,,
ACC120,Company120 Solutions,Agriculture,2023-09-05,Professional,3900,True,False,8,Passive,5,,
ACC121,Company121 Solutions,Construction,2023-12-24,Professional,2200,False,True,0,Detractor,2,2024-12-18,Switched to Competitor
ACC122,Company122 Solutions,Agriculture,2023-07-15,Enterprise,19100,True,False,6,Detractor,3,,
ACC123,Company123 Solutions,Technology,2023-09-15,Enterprise,19800,False,True,3,Detractor,1,2024-09-13,Switched to Competitor
ACC124,Company124 Solutions,Agriculture,2023-03-15,Enterprise,10900,True,False,8,Passive,4,,
ACC125,Company125 Solutions,Education,2023-11-16,Professional,2550,True,False,7,Passive,4,,
ACC126,Company126 Solutions,Logistics,2023-09-07,Professional,2250,True,False,1,Detractor,2,,
ACC127,Company127 Solutions,Retail,2023-02-20,Professional,3450,True,False,8,Passive,5,,
ACC128,Company128 Solutions,Cybersecurity,2023-09-14,Basic,100,True,False,8,Passive,3,,
ACC129,Company129 Solutions,Finance,2023-11-10,Enterprise,12500,True,False,6,Detractor,3,,
ACC130,Company130 Solutions,Construction,2023-10-31,Enterprise,13100,True,False,7,Passive,4,,
ACC131,Company131 Solutions,Technology,2023-10-31,Basic,200,True,False,8,Passive,3,,
ACC132,Company132 Solutions,Agriculture,2023-10-31,Professional,2750,True,False,7,Passive,4,,
ACC133,Company133 Solutions,Retail,2023-10-12,Professional,1950,True,False,8,Passive,5,,
"""

rel_value_csv = """Account_ID,Ticket_Count,Avg_Response_Time_Hours,Avg_Satisfaction_Score,NPS_Score,Touchpoints_Norm,Response_Time_Norm,Satisfaction_Norm,NPS_Norm,Relationship_Value (RV)
ACC001,1,2.9666666666666668,4,9,,,,,
ACC002,3,2.0611111111111109,3,8,,,,,
ACC003,5,1.07,3.8,6,,,,,
ACC004,4,1.775,2.25,3,,,,,
ACC005,4,2.979166666666667,4,9,,,,,
ACC006,1,0.28333333333333333,5,9,,,,,
ACC007,4,1.3083333333333329,4,9,,,,,
ACC008,1,1.4833333333333329,5,9,,,,,
ACC009,2,1.45,4.5,8,,,,,
ACC010,3,1.1388888888888891,4,8,,,,,
ACC011,3,2.6722222222222221,3.6666666666666665,8,,,,,
ACC012,2,2.375,5,10,,,,,
ACC013,3,1.3,3.8,6,,,,,
ACC014,3,2.238888888888889,2.25,0,,,,,
ACC015,2,2.716666666666667,3.75,6,,,,,
ACC016,2,1.25,4,9,,,,,
ACC017,3,2.7777777777777777,4.333333333333333,9,,,,,
ACC018,1,2.45,2,2,,,,,
ACC019,2,0.6166666666666667,2.3333333333333335,2,,,,,
ACC020,2,1.725,2,1,,,,,
ACC021,3,2.216666666666667,4.666666666666667,9,,,,,
ACC022,3,2.9555555555555557,4.333333333333333,8,,,,,
ACC023,3,2.4277777777777776,4.4,8,,,,,
ACC024,1,2.4166666666666665,3,8,,,,,
ACC025,3,2.7111111111111112,4.666666666666667,8,,,,,
ACC026,1,1.45,2.75,2,,,,,
ACC027,1,2.7999999999999998,5,10,,,,,
ACC028,1,0.4166666666666667,4,10,,,,,
ACC029,1,1.5,3.5,8,,,,,
ACC030,1,1.7916666666666667,3.6,7,,,,,
ACC031,2,1.7583333333333335,3,4,,,,,
ACC032,2,1.0583333333333333,2.25,3,,,,,
ACC033,1,3.4166666666666665,4,8,,,,,
ACC034,2,1.325,2.75,3,,,,,
ACC035,1,2.9166666666666665,3.6666666666666665,6,,,,,
ACC036,2,1.9083333333333334,3.6,8,,,,,
ACC037,1,1.9166666666666667,3,6,,,,,
ACC038,2,1.9166666666666667,2.6,3,,,,,
ACC039,2,1.2083333333333333,4,9,,,,,
ACC040,1,2.9166666666666665,4,10,,,,,
ACC041,1,1.7083333333333333,3.5,6,,,,,
ACC042,1,2.2083333333333335,2.2,0,,,,,
ACC043,1,3.9166666666666665,2,1,,,,,
ACC044,1,2.7916666666666665,3.3333333333333335,8,,,,,
ACC045,1,2.9166666666666665,2.3333333333333335,1,,,,,
ACC046,1,0.20833333333333334,5,10,,,,,
ACC047,2,1.0250000000000001,3.75,8,,,,,
ACC048,2,2.2083333333333335,4,8,,,,,
ACC049,1,1.9166666666666667,4,10,,,,,
ACC050,1,0.20833333333333334,4,10,,,,,
ACC051,1,1.7916666666666667,3.6,8,,,,,
ACC052,1,1.7083333333333333,3,8,,,,,
ACC053,1,0.20833333333333334,5,8,,,,,
ACC054,2,2.025,4.25,9,,,,,
ACC055,1,3.9166666666666665,5,10,,,,,
ACC056,2,1.5416666666666667,3.6,8,,,,,
ACC057,1,3.2083333333333335,3.5,7,,,,,
ACC058,2,2.075,3.25,6,,,,,
ACC059,2,3.5916666666666668,2,3,,,,,
ACC060,1,1.5833333333333333,2.6666666666666665,0,,,,,
ACC061,1,1.9166666666666667,5,10,,,,,
ACC062,1,0.7083333333333334,3.5,6,,,,,
ACC063,1,0.20833333333333334,4.5,9,,,,,
ACC064,1,1.7083333333333333,5,9,,,,,
ACC065,1,2.5,4.5,9,,,,,
ACC066,1,0.20833333333333334,3,1,,,,,
ACC067,1,1.4166666666666667,2.3333333333333335,1,,,,,
ACC068,2,2.2916666666666665,3,5,,,,,
ACC069,1,3.2083333333333335,4,9,,,,,
ACC070,1,2.9166666666666665,4.5,10,,,,,
ACC071,1,1.9166666666666667,3.6666666666666665,7,,,,,
ACC072,1,2.9166666666666665,4.2,8,,,,,
ACC073,2,3.2333333333333334,1.5,4,,,,,
ACC074,1,2.7083333333333335,3.3333333333333335,7,,,,,
ACC075,1,0.20833333333333334,4,7,,,,,
ACC076,1,0.20833333333333334,3.6,8,,,,,
ACC077,1,1.2083333333333333,4,9,,,,,
ACC078,1,2.4166666666666665,2.5,0,,,,,
ACC079,3,1.3277777777777777,3.1666666666666665,5,,,,,
ACC080,1,1.7916666666666667,4,8,,,,,
ACC081,1,0.20833333333333334,3.3333333333333335,6,,,,,
ACC082,1,0.20833333333333334,2.5,3,,,,,
ACC083,1,3.2083333333333335,3.5,8,,,,,
ACC084,1,1.5833333333333333,5,9,,,,,
ACC085,1,0.20833333333333334,3,6,,,,,
ACC086,1,0.20833333333333334,4,9,,,,,
ACC087,1,1.2083333333333333,3.3333333333333335,8,,,,,
ACC088,1,2.7083333333333335,2.5,6,,,,,
ACC089,1,1.9166666666666667,3.6,8,,,,,
ACC090,1,0.20833333333333334,3.5,9,,,,,
ACC091,1,0.20833333333333334,4,6,,,,,
ACC092,1,2.5,2.5,4,,,,,
ACC093,1,0.20833333333333334,3.5,8,,,,,
ACC094,1,2.35,2.35,10,,,,,
ACC095,3,2.088888888888889,2.088888888888889,6,,,,,
ACC096,5,1.6466666666666669,1.6466666666666669,8,,,,,
ACC097,4,1.4625,1.4625,10,,,,,
ACC098,1,3.1833333333333331,3.1833333333333331,2,,,,,
ACC099,1,1.2333333333333329,1.2333333333333329,7,,,,,
ACC100,3,2.1,2.1,8,,,,,
ACC101,3,2.338888888888889,2.338888888888889,3,,,,,
ACC102,2,0.98333333333333339,0.98333333333333339,9,,,,,
ACC103,5,1.236666666666667,1.236666666666667,7,,,,,
ACC104,5,2.0166666666666671,2.0166666666666671,6,,,,,
ACC105,3,3.072222222222222,3.072222222222222,9,,,,,
ACC106,3,4.2944444444444443,4.2944444444444443,9,,,,,
ACC107,3,3.9611111111111112,3.9611111111111112,6,,,,,
ACC108,3,2.5722222222222224,2.5722222222222224,7,,,,,
ACC109,2,4.625,4.625,4,,,,,
ACC110,2,2.7833333333333332,2.2916666666666665,6,,,,,
ACC111,2,3.1833333333333336,3.1833333333333336,8,,,,,
ACC112,2,1.1,1.1,8,,,,,
ACC113,3,2.177777777777778,2.177777777777778,9,,,,,
ACC114,3,4.322222222222222,4.322222222222222,6,,,,,
ACC115,3,4.2111111111111112,4.2111111111111112,8,,,,,
ACC116,4,4.333333333333333,4.333333333333333,6,,,,,
ACC117,2,1.1666666666666667,1.1666666666666667,3,,,,,
ACC118,3,3.6888888888888891,3.6888888888888891,8,,,,,
ACC119,4,3.875,3.875,7,,,,,
ACC120,4,4.208333333333333,4.208333333333333,8,,,,,
ACC121,2,2.5666666666666669,2.5666666666666669,0,,,,,
ACC122,2,1.1166666666666667,1.1166666666666667,6,,,,,
ACC123,2,2.2916666666666665,2.2916666666666665,3,,,,,
ACC124,4,4.291666666666667,4.291666666666667,8,,,,,
ACC125,3,1.1555555555555557,1.1555555555555557,7,,,,,
ACC126,2,3.1333333333333333,3.1333333333333333,1,,,,,
ACC127,1,3.1083333333333334,3.1083333333333334,8,,,,,
ACC128,1,3.6916666666666664,3.6916666666666664,8,,,,,
ACC129,2,3.6833333333333331,3.6833333333333331,6,,,,,
ACC130,2,2.5083333333333333,2.5083333333333333,7,,,,,
ACC131,2,2.9500000000000002,2.9500000000000002,8,,,,,
ACC132,2,3.9500000000000002,3.9500000000000002,7,,,,,
ACC133,2,1.1083333333333334,1.1083333333333334,8,,,,,
"""

exp_value_csv = """Account_ID,Seats,Unique_Features_Used,Total_Usage_Count,Adoption_Rate (raw),Utilization_Raw,Adoption_Norm,Utilization_Norm,"ExV (0.6 Adopt, 0.4 Util)"
ACC001,9,5,204,0.5,22.666666666666671,,,
ACC002,7,6,383,0.6,54.714285714285722,,,
ACC003,179,5,2480,0.5,13.854748603351959,,,
ACC004,51,8,1300,0.8,25.490196078431371,,,
ACC005,16,7,324,0.7,20.25,,,
ACC006,14,7,424,0.7,30.285714285714281,,,
ACC007,100,7,3401,0.7,34.01,,,
ACC008,16,5,178,0.5,11.125,,,
ACC009,45,6,767,0.6,17.044444444444441,,,
ACC010,79,4,794,0.4,10.050632911392405,,,
ACC011,11,7,261,0.7,23.727272727272727,,,
ACC012,9,4,129,0.4,14.333333333333332,,,
ACC013,141,4,1873,0.4,13.283687943262412,,,
ACC014,200,5,2056,0.5,10.28,,,
ACC015,54,6,838,0.6,15.518518518518519,,,
ACC016,37,6,915,0.6,24.72972972972973,,,
ACC017,5,7,331,0.7,66.2,,,
ACC018,154,8,3668,0.8,23.818181818181817,,,
ACC019,61,5,875,0.5,14.344262295081966,,,
ACC020,23,4,155,0.4,6.7391304347826084,,,
ACC021,20,7,274,0.7,13.7,,,
ACC022,141,7,4932,0.7,34.978723404255318,,,
ACC023,15,4,141,0.4,9.4,,,
ACC024,25,6,163,0.6,6.52,,,
ACC025,20,7,356,0.7,17.8,,,
ACC026,193,5,2077,0.5,10.761658031088083,,,
ACC027,59,5,533,0.5,9.0338983050847459,,,
ACC028,192,10,3904,1,20.333333333333332,,,
ACC029,47,4,646,0.4,13.74468085106383,,,
ACC030,22,5,362,0.5,16.454545454545453,,,
ACC031,55,6,935,0.6,17,,,
ACC032,22,8,263,0.8,11.954545454545455,,,
ACC033,97,6,3672,0.6,37.855670103092781,,,
ACC034,100,8,4920,0.8,49.2,,,
ACC035,23,6,125,0.6,5.4347826086956523,,,
ACC036,66,8,793,0.8,12.015151515151516,,,
ACC037,9,8,284,0.8,31.555555555555557,,,
ACC038,11,6,285,0.6,25.909090909090907,,,
ACC039,19,6,187,0.6,9.8421052631578938,,,
ACC040,103,7,3319,0.7,32.223300970873789,,,
ACC041,24,4,218,0.4,9.0833333333333339,,,
ACC042,46,5,740,0.5,16.086956521739133,,,
ACC043,38,9,1489,0.9,39.184210526315788,,,
ACC044,37,7,865,0.7,23.378378378378379,,,
ACC045,39,6,442,0.6,11.333333333333334,,,
ACC046,12,8,461,0.8,38.416666666666664,,,
ACC047,120,4,1805,0.4,15.041666666666666,,,
ACC048,132,6,2628,0.6,19.909090909090907,,,
ACC049,43,6,1329,0.6,30.906976744186047,,,
ACC050,15,6,144,0.6,9.6,,,
ACC051,43,7,792,0.7,18.418604651162791,,,
ACC052,13,5,80,0.5,6.1538461538461542,,,
ACC053,40,5,2087,0.5,52.175000000000004,,,
ACC054,49,8,2631,0.8,53.693877551020408,,,
ACC055,64,7,1620,0.7,25.3125,,,
ACC056,62,5,932,0.5,15.032258064516128,,,
ACC057,59,8,1825,0.8,30.932203389830509,,,
ACC058,54,9,980,0.9,18.148148148148149,,,
ACC059,49,4,576,0.4,11.755102040816327,,,
ACC060,141,5,2043,0.5,14.489361702127659,,,
ACC061,58,5,615,0.5,10.603448275862069,,,
ACC062,8,4,47,0.4,5.875,,,
ACC063,19,8,243,0.8,12.789473684210526,,,
ACC064,111,6,2735,0.6,24.639639639639641,,,
ACC065,38,6,930,0.6,24.473684210526315,,,
ACC066,46,4,240,0.4,5.2173913043478262,,,
ACC067,55,4,390,0.4,7.0909090909090908,,,
ACC068,131,5,2602,0.5,19.862595419847329,,,
ACC069,15,6,156,0.6,10.4,,,
ACC070,57,6,952,0.6,16.701754385964911,,,
ACC071,43,7,1588,0.7,36.930232558139537,,,
ACC072,142,8,4388,0.8,30.901408450704224,,,
ACC073,68,6,1722,0.6,25.323529411764707,,,
ACC074,8,4,71,0.4,8.875,,,
ACC075,150,8,4202,0.8,28.013333333333332,,,
ACC076,142,6,5846,0.6,41.16901408450704,,,
ACC077,8,5,94,0.5,11.75,,,
ACC078,73,9,2089,0.9,28.616438356164383,,,
ACC079,131,8,5177,0.8,39.519083969465647,,,
ACC080,142,5,4622,0.5,32.549295774647888,,,
ACC081,144,6,1754,0.6,12.180555555555555,,,
ACC082,73,4,756,0.4,10.356164383561644,,,
ACC083,142,5,1957,0.5,13.78169014084507,,,
ACC084,43,7,1109,0.7,25.790697674418606,,,
ACC085,46,5,772,0.5,16.782608695652176,,,
ACC086,15,7,464,0.7,30.933333333333334,,,
ACC087,7,5,143,0.5,20.428571428571427,,,
ACC088,57,8,670,0.8,11.754385964912281,,,
ACC089,34,5,402,0.5,11.823529411764707,,,
ACC090,45,7,1131,0.7,25.133333333333333,,,
ACC091,77,4,939,0.4,12.194805194805195,,,
ACC092,11,7,314,0.7,28.545454545454547,,,
ACC093,20,7,583,0.7,29.149999999999999,,,
ACC094,127,4,1887,0.4,14.858267716535433,,,
ACC095,6,6,225,0.6,37.5,,,
ACC096,163,4,1309,0.4,8.0306748466257662,,,
ACC097,20,6,103,0.6,5.15,,,
ACC098,23,5,247,0.5,10.739130434782609,,,
ACC099,80,3,408,0.3,5.1,,,
ACC100,144,7,2835,0.7,19.6875,,,
ACC101,46,4,480,0.4,10.434782608695651,,,
ACC102,19,4,216,0.4,11.368421052631581,,,
ACC103,142,8,3800,0.8,26.760563380281692,,,
ACC104,142,7,1975,0.7,13.908450704225352,,,
ACC105,33,8,839,0.8,25.424242424242426,,,
ACC106,131,5,1276,0.5,9.7404580152671755,,,
ACC107,46,7,987,0.7,21.456521739130434,,,
ACC108,13,6,350,0.6,26.923076923076923,,,
ACC109,21,5,309,0.5,14.714285714285714,,,
ACC110,6,4,53,0.4,8.8333333333333339,,,
ACC111,144,8,3449,0.8,23.951388888888889,,,
ACC112,39,9,1186,0.9,30.410256410256412,,,
ACC113,6,4,109,0.4,18.166666666666668,,,
ACC114,6,8,78,0.8,13,,,
ACC115,142,7,2456,0.7,17.295774647887324,,,
ACC116,33,6,589,0.6,17.848484848484848,,,
ACC117,49,4,256,0.4,5.2244897959183674,,,
ACC118,18,5,235,0.5,13.055555555555555,,,
ACC119,197,8,5073,0.8,25.751269035532996,,,
ACC120,78,7,1843,0.7,23.628205128205128,,,
ACC121,44,6,517,0.6,11.75,,,
ACC122,191,6,3910,0.6,20.471204188481674,,,
ACC123,198,6,3440,0.6,17.373737373737374,,,
ACC124,109,6,1534,0.6,14.073394495412845,,,
ACC125,51,7,599,0.7,11.745098039215687,,,
ACC126,45,6,831,0.6,18.466666666666665,,,
ACC127,69,9,2100,0.9,30.434782608695652,,,
ACC128,5,7,55,0.7,10.95,,,
ACC129,125,5,2333,0.5,18.664,,,
ACC130,131,5,1407,0.5,10.740458015267175,,,
ACC131,10,7,293,0.7,29.299999999999997,,,
ACC132,55,6,1072,0.6,19.490909090909092,,,
ACC133,39,9,1610,0.9,41.282051282051285,,,
"""

expected_value_csv = """Account_ID,MRR_Amount,NPS_Score,MRR_Normalized,NPS_Normalized,Expected_Value
ACC001,180,9,0.009,0.9,0.2763
ACC002,140,8,0.007,0.8,0.24489999999999998
ACC003,17900,6,0.895,0.6,0.8065
ACC004,2550,3,0.1275,0.3,0.17925
ACC005,320,9,0.016,0.9,0.2812
ACC006,280,9,0.014,0.9,0.2798
ACC007,10000,9,0.5,0.9,0.62
ACC008,320,9,0.016,0.9,0.2812
ACC009,2250,8,0.1125,0.8,0.31875
ACC010,3950,8,0.1975,0.8,0.37825
ACC011,220,8,0.011,0.8,0.2477
ACC012,180,10,0.009,1,0.3063
ACC013,14100,6,0.705,0.6,0.6735
ACC014,20000,0,1,0,0.7
ACC015,2700,6,0.135,0.6,0.2745
ACC016,1850,9,0.0925,0.9,0.33475
ACC017,100,9,0.005,0.9,0.2735
ACC018,15400,2,0.77,0.2,0.599
ACC019,3050,2,0.1525,0.2,0.16675
ACC020,460,1,0.023,0.1,0.0461
ACC021,400,9,0.02,0.9,0.284
ACC022,14100,8,0.705,0.8,0.7335
ACC023,300,8,0.015,0.8,0.2505
ACC024,500,8,0.025,0.8,0.2575
ACC025,400,8,0.02,0.8,0.254
ACC026,19300,2,0.965,0.2,0.73550000000000004
ACC027,2950,10,0.1475,1,0.40325
ACC028,19200,10,0.96,1,0.972
ACC029,2350,8,0.1175,0.8,0.32225
ACC030,440,7,0.022,0.7,0.2254
ACC031,2750,4,0.1375,0.4,0.21625
ACC032,440,3,0.022,0.3,0.1054
ACC033,9700,8,0.485,0.8,0.5795
ACC034,10000,3,0.5,0.3,0.44
ACC035,460,6,0.023,0.6,0.1961
ACC036,3300,8,0.165,0.8,0.3555
ACC037,180,6,0.009,0.6,0.1863
ACC038,220,3,0.011,0.3,0.097700000000000009
ACC039,380,9,0.019,0.9,0.28329999999999999
ACC040,10300,10,0.515,1,0.6605
ACC041,480,6,0.024,0.6,0.1968
ACC042,2300,0,0.115,0,0.080499999999999988
ACC043,1900,1,0.095,0.1,0.0965
ACC044,1850,8,0.0925,0.8,0.30475
ACC045,1950,1,0.0975,0.1,0.09825
ACC046,240,10,0.012,1,0.3084
ACC047,12000,8,0.6,0.8,0.66
ACC048,13200,8,0.66,0.8,0.70199999999999996
ACC049,2150,10,0.1075,1,0.37525
ACC050,300,10,0.015,1,0.3105
ACC051,2150,8,0.1075,0.8,0.31525
ACC052,260,8,0.013,0.8,0.2491
ACC053,2000,8,0.1,0.8,0.31
ACC054,2450,9,0.1225,0.9,0.35575
ACC055,3200,10,0.16,1,0.412
ACC056,3100,8,0.155,0.8,0.3485
ACC057,2950,7,0.1475,0.7,0.31325
ACC058,2700,6,0.135,0.6,0.2745
ACC059,2450,3,0.1225,0.3,0.17575
ACC060,14100,0,0.705,0,0.4935
ACC061,2900,10,0.145,1,0.4015
ACC062,160,6,0.008,0.6,0.1856
ACC063,380,9,0.019,0.9,0.28329999999999999
ACC064,11100,9,0.555,0.9,0.6585
ACC065,1900,9,0.095,0.9,0.3365
ACC066,2300,1,0.115,0.1,0.1105
ACC067,2750,1,0.1375,0.1,0.12625
ACC068,13100,5,0.655,0.5,0.6085
ACC069,300,9,0.015,0.9,0.2805
ACC070,2850,10,0.1425,1,0.39975
ACC071,2150,7,0.1075,0.7,0.28525
ACC072,14200,8,0.71,0.8,0.737
ACC073,3400,4,0.17,0.4,0.239
ACC074,160,7,0.008,0.7,0.2156
ACC075,15000,7,0.75,0.7,0.735
ACC076,14200,8,0.71,0.8,0.737
ACC077,160,9,0.008,0.9,0.2756
ACC078,3650,0,0.1825,0,0.12775
ACC079,13100,5,0.655,0.5,0.6085
ACC080,14200,8,0.71,0.8,0.737
ACC081,14400,6,0.72,0.6,0.684
ACC082,3650,3,0.1825,0.3,0.21775
ACC083,14200,8,0.71,0.8,0.737
ACC084,2150,9,0.1075,0.9,0.34525
ACC085,2300,6,0.115,0.6,0.2605
ACC086,300,9,0.015,0.9,0.2805
ACC087,140,8,0.007,0.8,0.24489999999999998
ACC088,2850,6,0.1425,0.6,0.27975
ACC089,1700,8,0.085,0.8,0.2995
ACC090,2250,9,0.1125,0.9,0.34875
ACC091,3850,6,0.1925,0.6,0.31475
ACC092,220,4,0.011,0.4,0.1277
ACC093,400,8,0.02,0.8,0.254
ACC094,12700,10,0.635,1,0.74449999999999994
ACC095,120,6,0.006,0.6,0.1842
ACC096,16300,8,0.815,0.8,0.81049999999999989
ACC097,400,10,0.02,1,0.314
ACC098,460,2,0.023,0.2,0.0761
ACC099,4000,7,0.2,0.7,0.35
ACC100,14400,8,0.72,0.8,0.744
ACC101,2300,3,0.115,0.3,0.17049999999999998
ACC102,460,9,0.023,0.9,0.2861
ACC103,14200,7,0.71,0.7,0.707
ACC104,14200,6,0.71,0.6,0.677
ACC105,1650,9,0.0825,0.9,0.32775
ACC106,13100,9,0.655,0.9,0.72850000000000004
ACC107,2300,6,0.115,0.6,0.2605
ACC108,260,7,0.013,0.7,0.21910000000000002
ACC109,420,4,0.021,0.4,0.13470000000000001
ACC110,120,6,0.006,0.6,0.1842
ACC111,14400,8,0.72,0.8,0.744
ACC112,1950,8,0.0975,0.8,0.30825
ACC113,120,9,0.006,0.9,0.2742
ACC114,120,6,0.006,0.6,0.1842
ACC115,14200,8,0.71,0.8,0.737
ACC116,1650,6,0.0825,0.6,0.23775
ACC117,2450,3,0.1225,0.3,0.17575
ACC118,360,8,0.018,0.8,0.2526
ACC119,19700,7,0.985,0.7,0.8995
ACC120,3900,8,0.195,0.8,0.3765
ACC121,2200,0,0.11,0,0.077000000000000012
ACC122,19100,6,0.955,0.6,0.84850000000000003
ACC123,19800,3,0.99,0.3,0.78300000000000003
ACC124,10900,8,0.545,0.8,0.6215
ACC125,2550,7,0.1275,0.7,0.29925
ACC126,2250,1,0.1125,0.1,0.10875
ACC127,3450,8,0.1725,0.8,0.36075
ACC128,100,8,0.005,0.8,0.2435
ACC129,12500,6,0.625,0.6,0.61750000000000005
ACC130,13100,7,0.655,0.7,0.6685
ACC131,200,8,0.01,0.8,0.247
ACC132,2750,7,0.1375,0.7,0.30625
ACC133,1950,8,0.0975,0.8,0.30825
"""

# ==========================================
# 2. DATA LOADING & PROCESSING
# ==========================================

@st.cache_data
def load_and_process_data():
    # Load raw dataframes from strings
    contracts_df = pd.read_csv(io.StringIO(subscription_csv))
    usage_aggregates = pd.read_csv(io.StringIO(usage_aggregates_csv))
    support_df = pd.read_csv(io.StringIO(support_csv))
    churn_df = pd.read_csv(io.StringIO(churn_csv))
    nps_df = pd.read_csv(io.StringIO(nps_csv))
    accounts_df = pd.read_csv(io.StringIO(account_csv))
    rel_val_df = pd.read_csv(io.StringIO(rel_value_csv))
    exp_val_df = pd.read_csv(io.StringIO(exp_value_csv))
    expected_val_df = pd.read_csv(io.StringIO(expected_value_csv))

    # --- Date Conversion ---
    contracts_df['start_date'] = pd.to_datetime(contracts_df['start_date'], dayfirst=True)
    usage_aggregates['First usage_date'] = pd.to_datetime(usage_aggregates['First usage_date'])
    support_df['submitted_at'] = pd.to_datetime(support_df['submitted_at'], dayfirst=True)
    support_df['closed_at'] = pd.to_datetime(support_df['closed_at'], dayfirst=True)
    churn_df['churn_date'] = pd.to_datetime(churn_df['churn_date'])

    # --- 1. TTFV ---
    ttfv_df = pd.merge(usage_aggregates, contracts_df[['account_id', 'start_date']], on='account_id', how='left')
    ttfv_df['TTFV_Days'] = (ttfv_df['First usage_date'] - ttfv_df['start_date']).dt.days
    ttfv_df['TTFV_Days'] = ttfv_df['TTFV_Days'].apply(lambda x: max(x, 0)) # Clean negatives

    # --- 2. Support Friction ---
    support_mapped = pd.merge(support_df, contracts_df[['account_id', 'start_date']], on='account_id', how='left')
    # Filter: submitted within 90 days of start
    tickets_90d = support_mapped[
        (support_mapped['submitted_at'] >= support_mapped['start_date']) &
        (support_mapped['submitted_at'] <= support_mapped['start_date'] + pd.Timedelta(days=90))
    ].copy()
    
    tickets_90d['resolution_time_hours'] = (tickets_90d['closed_at'] - tickets_90d['submitted_at']).dt.total_seconds() / 3600
    
    friction_df = tickets_90d.groupby('account_id').agg(
        Ticket_Count_90D=('ticket_id', 'count'),
        Avg_Resolution_Time=('resolution_time_hours', 'mean')
    ).reset_index()

    # --- 3. Early Churn ---
    churn_mapped = pd.merge(contracts_df[['account_id', 'start_date']], churn_df[['account_id', 'churn_date']], on='account_id', how='left')
    def get_early_churn(row):
        if pd.isnull(row['churn_date']): return 0
        if row['start_date'] <= row['churn_date'] <= (row['start_date'] + pd.Timedelta(days=90)): return 1
        return 0
    churn_mapped['Early_Churn_Flag'] = churn_mapped.apply(get_early_churn, axis=1)
    early_churn_metrics = churn_mapped[['account_id', 'Early_Churn_Flag']]

    # --- 4. Merge All Metrics ---
    base_df = contracts_df[['account_id']].copy()
    base_df = pd.merge(base_df, ttfv_df[['account_id', 'TTFV_Days', 'Features_Used_90D']], on='account_id', how='left')
    base_df = pd.merge(base_df, friction_df, on='account_id', how='left')
    base_df = pd.merge(base_df, early_churn_metrics, on='account_id', how='left')
    base_df = pd.merge(base_df, nps_df[['account_id', 'nps_score', 'nps_category', 'relationship_csat_score']], on='account_id', how='left')

    # Fill NaNs
    base_df['Features_Used_90D'] = base_df['Features_Used_90D'].fillna(0)
    base_df['Ticket_Count_90D'] = base_df['Ticket_Count_90D'].fillna(0)
    base_df['Avg_Resolution_Time'] = base_df['Avg_Resolution_Time'].fillna(0)
    max_ttfv = base_df['TTFV_Days'].max()
    if pd.isna(max_ttfv): max_ttfv = 90
    base_df['TTFV_Days'] = base_df['TTFV_Days'].fillna(max_ttfv)

    # --- 5. Scoring Logic ---
    # Value
    base_df['Value_Score'] = 100 * (1 - (base_df['TTFV_Days'] / max_ttfv))
    
    # Adoption (10 features max)
    base_df['Adoption_Score'] = 100 * (base_df['Features_Used_90D'] / 10)
    
    # Friction
    max_tickets = base_df['Ticket_Count_90D'].max() or 1
    base_df['Ticket_SubScore'] = 100 * (1 - (base_df['Ticket_Count_90D'] / max_tickets))
    
    max_res = base_df['Avg_Resolution_Time'].max() or 1
    base_df['Resolution_SubScore'] = 100 * (1 - (base_df['Avg_Resolution_Time'] / max_res))
    
    base_df['Friction_Score'] = (base_df['Ticket_SubScore'] + base_df['Resolution_SubScore']) / 2
    
    # Relationship
    def calc_nps_val(score):
        if pd.isnull(score): return 50
        if score >= 9: return 100
        if score >= 7: return 50
        return 0
    
    base_df['NPS_Norm_Score'] = base_df['nps_score'].apply(calc_nps_val)
    base_df['CSAT_Norm_Score'] = (base_df['relationship_csat_score'] / 5) * 100
    base_df['Retention_Score'] = base_df['Early_Churn_Flag'].apply(lambda x: 0 if x == 1 else 100)
    
    base_df['Relationship_Score'] = (base_df['NPS_Norm_Score'] + base_df['CSAT_Norm_Score'] + base_df['Retention_Score']) / 3

    # Composite Health Score
    base_df['Health_Score'] = (
        0.25 * base_df['Value_Score'] +
        0.30 * base_df['Adoption_Score'] +
        0.20 * base_df['Friction_Score'] +
        0.25 * base_df['Relationship_Score']
    )

    def get_zone(score):
        if score >= 75: return 'Green'
        if score >= 50: return 'Yellow'
        return 'Red'
    base_df['Health_Zone'] = base_df['Health_Score'].apply(get_zone)

    # --- 6. Strategic Value Integration ---
    final_df = pd.merge(base_df, accounts_df[['account_id', 'account_name', 'industry', 'plan_tier']], on='account_id', how='left')
    
    # Strip whitespace from CSV headers just in case
    rel_val_df.columns = rel_val_df.columns.str.strip()
    exp_val_df.columns = exp_val_df.columns.str.strip()
    expected_val_df.columns = expected_val_df.columns.str.strip()

    final_df = pd.merge(final_df, rel_val_df[['Account_ID', 'Avg_Satisfaction_Score']], left_on='account_id', right_on='Account_ID', how='left')
    final_df = pd.merge(final_df, exp_val_df[['Account_ID', 'Utilization_Raw', 'Adoption_Rate (raw)']], left_on='account_id', right_on='Account_ID', how='left')
    final_df = pd.merge(final_df, expected_val_df[['Account_ID', 'Expected_Value', 'MRR_Amount']], left_on='account_id', right_on='Account_ID', how='left')

    final_df = final_df.drop(columns=['Account_ID_x', 'Account_ID_y', 'Account_ID'])
    final_df.fillna(0, inplace=True)
    
    return final_df

# ==========================================
# 3. DASHBOARD UI
# ==========================================

st.set_page_config(page_title="Customer Health Dashboard", layout="wide")

df = load_and_process_data()

# --- Header ---
st.title("Customer Health & Strategic Value Dashboard")
st.markdown("### Portfolio Analysis  133 Accounts  Integrated Value Metrics")

# --- Top Level KPIs ---
col1, col2, col3, col4 = st.columns(4)
avg_health = df['Health_Score'].mean()
green_count = len(df[df['Health_Zone'] == 'Green'])
yellow_count = len(df[df['Health_Zone'] == 'Yellow'])
red_count = len(df[df['Health_Zone'] == 'Red'])

with col1:
    st.metric("Avg Health Score", f"{avg_health:.1f}", delta_color="normal")
with col2:
    st.metric("Healthy (Green)", f"{green_count}", delta_color="normal")
with col3:
    st.metric("At Risk (Yellow)", f"{yellow_count}", delta_color="normal")
with col4:
    st.metric("High Risk (Red)", f"{red_count}", delta="-Critical")

# --- Tabs ---
tabs = st.tabs(["Overview", " Strategic Value", "Value Realization", "Product Adoption", "Support Friction", "Relationship"])

# TAB 1: OVERVIEW
with tabs[0]:
    c1, c2 = st.columns(2)
    
    with c1:
        st.subheader("Health Zone Distribution")
        fig_zone = px.pie(df, names='Health_Zone', color='Health_Zone', 
                          color_discrete_map={'Green':'#22c55e', 'Yellow':'#eab308', 'Red':'#ef4444'},
                          hole=0.6)
        st.plotly_chart(fig_zone, use_container_width=True)
    
    with c2:
        st.subheader("Score Breakdown (Portfolio Avg)")
        avg_scores = pd.DataFrame({
            'Category': ['Value', 'Adoption', 'Friction', 'Relationship'],
            'Score': [
                df['Value_Score'].mean(),
                df['Adoption_Score'].mean(),
                df['Friction_Score'].mean(),
                df['Relationship_Score'].mean()
            ]
        })
        fig_radar = px.line_polar(avg_scores, r='Score', theta='Category', line_close=True)
        fig_radar.update_traces(fill='toself')
        st.plotly_chart(fig_radar, use_container_width=True)

# TAB 2: STRATEGIC VALUE
with tabs[1]:
    kpi1, kpi2, kpi3 = st.columns(3)
    kpi1.metric("Avg Expected Value", f"{df['Expected_Value'].mean():.2f}", "Predictive Score (0-1)")
    kpi2.metric("Total MRR", f"${df['MRR_Amount'].sum()/1000:.1f}k", "Monthly Revenue")
    kpi3.metric("Avg Utilization", f"{df['Utilization_Raw'].mean():.1f}%", "Usage per Seat")
    
    st.divider()
    
    c1, c2 = st.columns(2)
    with c1:
        st.subheader("The Value Matrix")
        st.caption("Identify 'Cash Cows' (High MRR, High Value) vs 'Flight Risks'")
        fig_matrix = px.scatter(df, x="MRR_Amount", y="Expected_Value", 
                                color="Health_Zone", 
                                color_discrete_map={'Green':'#22c55e', 'Yellow':'#eab308', 'Red':'#ef4444'},
                                hover_name="account_name", size_max=60)
        st.plotly_chart(fig_matrix, use_container_width=True)
        
    with c2:
        st.subheader("Sentiment vs Reality")
        st.caption("Are happy customers actually using the product?")
        fig_sent = px.scatter(df, x="Adoption_Rate (raw)", y="Avg_Satisfaction_Score",
                              color="Health_Zone",
                              color_discrete_map={'Green':'#22c55e', 'Yellow':'#eab308', 'Red':'#ef4444'},
                              labels={"Adoption_Rate (raw)": "Adoption Rate (0-1)", "Avg_Satisfaction_Score": "CSAT (1-5)"},
                              hover_name="account_name")
        st.plotly_chart(fig_sent, use_container_width=True)
    
    st.subheader("Utilization Intensity Distribution")
    fig_util = px.histogram(df, x="Utilization_Raw", nbins=20, title="Frequency of Utilization Scores")
    st.plotly_chart(fig_util, use_container_width=True)

# TAB 3: VALUE REALIZATION
with tabs[2]:
    c1, c2 = st.columns([2, 1])
    with c1:
        st.subheader("Time to First Value (TTFV) Distribution")
        fig_ttfv = px.histogram(df, x="TTFV_Days", nbins=20, color_discrete_sequence=['#3b82f6'])
        st.plotly_chart(fig_ttfv, use_container_width=True)
    with c2:
        st.info(" Insight")
        st.markdown(f"""
        **Average TTFV:** {df['TTFV_Days'].mean():.0f} Days  
        A significant portion of users take **>60 days** to activate.  
        **Strategy:** Focus onboarding efforts on shortening this cycle.
        """)

# TAB 4: ADOPTION
with tabs[3]:
    c1, c2 = st.columns([2, 1])
    with c1:
        st.subheader("Feature Usage Frequency")
        fig_adopt = px.bar(df['Features_Used_90D'].value_counts().sort_index(), 
                           labels={'value': 'Count of Accounts', 'index': 'Features Used'},
                           color_discrete_sequence=['#a855f7'])
        st.plotly_chart(fig_adopt, use_container_width=True)
    with c2:
        st.info(" Insight")
        st.markdown(f"""
        **Avg Features Used:** {df['Features_Used_90D'].mean():.1f} / 10  
        The "Adoption Gap" is visible at the 2-feature mark.  
        **Risk:** Customers using < 3 features are at higher risk of churn.
        """)

# TAB 5: FRICTION
with tabs[4]:
    c1, c2 = st.columns([2, 1])
    with c1:
        st.subheader("Ticket Volume vs. Resolution Time")
        fig_fric = px.scatter(df, x="Ticket_Count_90D", y="Avg_Resolution_Time",
                              color="Health_Zone",
                              color_discrete_map={'Green':'#22c55e', 'Yellow':'#eab308', 'Red':'#ef4444'},
                              hover_name="account_name")
        st.plotly_chart(fig_fric, use_container_width=True)
    with c2:
        st.info(" Insight")
        st.markdown(f"""
        **Avg Resolution Time:** {df['Avg_Resolution_Time'].mean():.1f} Hours  
        Outliers in the top-right quadrant (High Tickets + Slow Resolution) require immediate technical account management.
        """)

# TAB 6: RELATIONSHIP
with tabs[5]:
    c1, c2 = st.columns([2, 1])
    with c1:
        st.subheader("NPS Category Distribution")
        fig_nps = px.pie(df, names='nps_category', 
                         color='nps_category',
                         color_discrete_map={'Promoter':'#22c55e', 'Passive':'#cbd5e1', 'Detractor':'#ef4444'},
                         hole=0.4)
        st.plotly_chart(fig_nps, use_container_width=True)
    with c2:
        st.info(" Insight")
        st.markdown(f"""
        **Avg NPS Score:** {df['nps_score'].mean():.1f}  
        A high percentage of "Passives" indicates a stable but vulnerable base. Conversion campaigns are needed.
        """)

# --- Detailed Data Table ---
st.divider()
st.subheader("Account Health & Value Details")

# Filter columns for cleaner view
display_cols = [
    'account_id', 'account_name', 'industry', 'plan_tier',
    'Health_Zone', 'Health_Score', 
    'Expected_Value', 'MRR_Amount', 'Utilization_Raw',
    'TTFV_Days', 'Features_Used_90D', 'nps_score'
]

# Interactive Dataframe
def highlight_zone(val):
    if val == 'Green': return 'background-color: #dcfce7; color: #166534'
    if val == 'Yellow': return 'background-color: #fef9c3; color: #854d0e'
    if val == 'Red': return 'background-color: #fee2e2; color: #991b1b'
    return ''

st.dataframe(
    df[display_cols].style.applymap(highlight_zone, subset=['Health_Zone']),
    use_container_width=True
)
